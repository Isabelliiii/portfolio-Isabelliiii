[
  {
    "objectID": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html",
    "href": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html",
    "title": "Philadelphia Housing Model",
    "section": "",
    "text": "Code\n# Load necessary libraries\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(tidycensus)\nlibrary(knitr)\nlibrary(tigris)\noptions(tigris_use_cache = TRUE, tigris_class = \"sf\")\nlibrary(MASS)\nlibrary(dplyr)\nlibrary(scales)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(caret)\nlibrary(tibble)\nlibrary(gt)\nlibrary(lm.beta)\nlibrary(broom)\n# Add this near the top of your .qmd after loading libraries\noptions(tigris_use_cache = TRUE)\noptions(tigris_progress = FALSE)  # Suppress tigris progress bars\n\n\n\n\n\n\n\nCode\n# load data\nopa &lt;- read_csv(\"data/opa_properties_public.csv\")\n# filter sales (2023 - 2024)\nopa_clean &lt;- opa %&gt;%\n  mutate(sale_date = as.Date(sale_date)) %&gt;%\n  filter(sale_date &gt;= \"2023-01-01\" & sale_date &lt;= \"2024-12-31\")\n# Select relevant variables \nopa_var &lt;- opa_clean %&gt;%\n  dplyr::select(\n    sale_date, sale_price, market_value, building_code_description,\n    total_livable_area, number_of_bedrooms, number_of_bathrooms,\n    number_stories, garage_spaces, central_air, quality_grade,\n    interior_condition, exterior_condition, year_built,\n    zip_code, geographic_ward, census_tract, zoning, owner_1,\n    category_code_description, shape\n  )\n#filter to residential properties(SINGLE FAMILY)\nopa_var &lt;- opa_var %&gt;% \n  filter(category_code_description == \"SINGLE FAMILY\") %&gt;%\n  distinct() %&gt;%\n  filter(\n    !is.na(total_livable_area) & total_livable_area &gt; 0,\n    !is.na(year_built) & year_built &gt; 1800 & year_built &lt;= 2025,\n  )    \n# remove obvious errors & handle missing values, create house age\nopa_var &lt;- opa_var %&gt;%\n  mutate(\n    non_market = ((sale_price / market_value &lt; 0.05) & sale_price &lt; 2000),\n    house_age = 2025 - year_built\n  )\nopa_selected &lt;- opa_var %&gt;% \n  filter(\n    non_market==0\n  )   \nopa_selected &lt;- opa_selected %&gt;%\n  filter(sale_price &lt;= quantile(sale_price, 0.98, na.rm = TRUE))\n\n\n\n\nCode\n# Transform to sf object \nopa_sf &lt;- st_as_sf(opa_selected, wkt = \"shape\", crs = 2272) %&gt;%\n  st_transform(4326)\n\n\n\n\n\n\n\nCode\n# Load Census data for Philadelphia tracts\nphilly_census &lt;- get_acs(\n  geography = \"tract\",\n  variables = c(\n    total_pop = \"B01003_001\",\n    black = \"B02001_003\",\n    ba_degree = \"B15003_022\",\n    total_edu = \"B15003_001\",\n    median_income = \"B19013_001\",\n    labor_force = \"B23025_003\",\n    unemployed = \"B23025_005\"\n  ),\n  year = 2023,\n  state = \"PA\",\n  county = \"Philadelphia\",\n  geometry = TRUE\n) %&gt;%\n  dplyr::select(GEOID, variable, estimate, geometry) %&gt;%   # ← 用 dplyr::\n  tidyr::pivot_wider(names_from = variable, values_from = estimate) %&gt;%\n  dplyr::mutate(\n    ba_rate = 100 * ba_degree / total_edu,\n    unemployment_rate = 100 * unemployed / labor_force,\n    black_share = 100 * black/total_pop\n  ) %&gt;%\n  st_transform(st_crs(opa_sf))\n\n# Spatial join of OPA data with Census data\nopa_census &lt;- st_join(opa_sf, philly_census, join = st_within) %&gt;%\n  filter(!is.na(median_income))\n\n#garage dummy\nopa_census &lt;- opa_census %&gt;%\n  mutate(\n    has_garage = if_else(!is.na(garage_spaces) & garage_spaces &gt; 0, 1L, 0L)\n  )\n\n\n\n\n\n\n\nCode\n# Original data dimensions\nopa_dims &lt;- tibble(\n  dataset = \"opa (raw CSV)\",\n  rows = nrow(opa),\n  columns = ncol(opa)\n)\n\n# cleaned data dimensions\nopa_filter_dims &lt;- tibble(\n  dataset = \"opa (filtered)\",\n  rows = nrow(opa_clean),\n  columns = ncol(opa_clean)\n)\nopa_selected_dims &lt;- tibble(\n  dataset = \"opa (cleaned & selected)\",\n  rows = nrow(opa_selected),\n  columns = ncol(opa_selected)\n)\n# data dimensions (within census tracts)\nopa_census_dims &lt;- tibble(\n  dataset = \"opa (spatial joined)\",\n  rows = nrow(opa_census),\n  columns = ncol(opa_census)\n)\n\n# create summary table\nsummary_table &lt;- bind_rows(opa_dims, opa_filter_dims,opa_selected_dims, opa_census_dims)\nsummary_table %&gt;%\n  kable(caption = \"Summary of OPA data before and after cleaning\")\n\n\n\nSummary of OPA data before and after cleaning\n\n\ndataset\nrows\ncolumns\n\n\n\n\nopa (raw CSV)\n583776\n79\n\n\nopa (filtered)\n42383\n79\n\n\nopa (cleaned & selected)\n25860\n23\n\n\nopa (spatial joined)\n25585\n35\n\n\n\n\n\n\n\nCode\n# load the neighborhood data by ward\nwards &lt;- st_read(\"data/Political_Wards.geojson\", quiet = TRUE) %&gt;%\n  st_transform(st_crs(opa_census))\n\n\n\n\n\nDuring the data preparation phase, several cleaning and filtering steps were performed to ensure the reliability of the Philadelphia property sales dataset.\n\nFiltering and selecting relevant variables\nOnly single-family residential properties were retained to maintain consistency in property type. Sales were limited to 2023–2024 to focus on the most recent housing market conditions.A subset of relevant columns—such as property characteristics, sale price, and geographic information—was retained to reduce processing time and support exploratory analysis.\nRemoving obvious errors and handling missing values\nExtremely low sale prices—often suspected to be due to inheritance transfers—were excluded to avoid biasing the model. Properties with a reported construction year of “0” were also removed, as these are unrealistic. Similarly, properties with nonpositive living area were excluded, since living area must be greater than zero.\nTransforming to spatial format and calculating additional attributes\nThe cleaned dataset was then converted to an sf (spatial features) object to enable spatial analysis. An additional variable, house age, was calculated based on the difference between the sale year and the year built, allowing for further filtering of unrealistic building ages and facilitating later modeling steps.\nIntegrating census and spatial amenity data\nCensus tract–level socioeconomic data were obtained via the tidycensus package and spatially joined to the property dataset using st_within(). This ensured that only properties located within the official boundaries of Philadelphia were retained. Additional contextual datasets from OpenDataPhilly (e.g., parks, schools, and public facilities)—were also prepared in phase 3 for subsequent analysis to examine how neighborhood characteristics may influence property prices.\nFinal dataset summary\nThrough this cleaning and integration process, the dataset was reduced from 583,776 initial records to 42,383 after initial filtering, and then to 25,860 after further refinement. Following the spatial join with census tract data, the final analytical dataset contained 25,585 valid property records with complete socioeconomic and spatial information."
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-1-data-preparation",
    "href": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-1-data-preparation",
    "title": "Philadelphia Housing Model",
    "section": "",
    "text": "Code\n# Load necessary libraries\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(tidycensus)\nlibrary(knitr)\nlibrary(tigris)\noptions(tigris_use_cache = TRUE, tigris_class = \"sf\")\nlibrary(MASS)\nlibrary(dplyr)\nlibrary(scales)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(caret)\nlibrary(tibble)\nlibrary(gt)\nlibrary(lm.beta)\nlibrary(broom)\n# Add this near the top of your .qmd after loading libraries\noptions(tigris_use_cache = TRUE)\noptions(tigris_progress = FALSE)  # Suppress tigris progress bars\n\n\n\n\n\n\n\nCode\n# load data\nopa &lt;- read_csv(\"data/opa_properties_public.csv\")\n# filter sales (2023 - 2024)\nopa_clean &lt;- opa %&gt;%\n  mutate(sale_date = as.Date(sale_date)) %&gt;%\n  filter(sale_date &gt;= \"2023-01-01\" & sale_date &lt;= \"2024-12-31\")\n# Select relevant variables \nopa_var &lt;- opa_clean %&gt;%\n  dplyr::select(\n    sale_date, sale_price, market_value, building_code_description,\n    total_livable_area, number_of_bedrooms, number_of_bathrooms,\n    number_stories, garage_spaces, central_air, quality_grade,\n    interior_condition, exterior_condition, year_built,\n    zip_code, geographic_ward, census_tract, zoning, owner_1,\n    category_code_description, shape\n  )\n#filter to residential properties(SINGLE FAMILY)\nopa_var &lt;- opa_var %&gt;% \n  filter(category_code_description == \"SINGLE FAMILY\") %&gt;%\n  distinct() %&gt;%\n  filter(\n    !is.na(total_livable_area) & total_livable_area &gt; 0,\n    !is.na(year_built) & year_built &gt; 1800 & year_built &lt;= 2025,\n  )    \n# remove obvious errors & handle missing values, create house age\nopa_var &lt;- opa_var %&gt;%\n  mutate(\n    non_market = ((sale_price / market_value &lt; 0.05) & sale_price &lt; 2000),\n    house_age = 2025 - year_built\n  )\nopa_selected &lt;- opa_var %&gt;% \n  filter(\n    non_market==0\n  )   \nopa_selected &lt;- opa_selected %&gt;%\n  filter(sale_price &lt;= quantile(sale_price, 0.98, na.rm = TRUE))\n\n\n\n\nCode\n# Transform to sf object \nopa_sf &lt;- st_as_sf(opa_selected, wkt = \"shape\", crs = 2272) %&gt;%\n  st_transform(4326)\n\n\n\n\n\n\n\nCode\n# Load Census data for Philadelphia tracts\nphilly_census &lt;- get_acs(\n  geography = \"tract\",\n  variables = c(\n    total_pop = \"B01003_001\",\n    black = \"B02001_003\",\n    ba_degree = \"B15003_022\",\n    total_edu = \"B15003_001\",\n    median_income = \"B19013_001\",\n    labor_force = \"B23025_003\",\n    unemployed = \"B23025_005\"\n  ),\n  year = 2023,\n  state = \"PA\",\n  county = \"Philadelphia\",\n  geometry = TRUE\n) %&gt;%\n  dplyr::select(GEOID, variable, estimate, geometry) %&gt;%   # ← 用 dplyr::\n  tidyr::pivot_wider(names_from = variable, values_from = estimate) %&gt;%\n  dplyr::mutate(\n    ba_rate = 100 * ba_degree / total_edu,\n    unemployment_rate = 100 * unemployed / labor_force,\n    black_share = 100 * black/total_pop\n  ) %&gt;%\n  st_transform(st_crs(opa_sf))\n\n# Spatial join of OPA data with Census data\nopa_census &lt;- st_join(opa_sf, philly_census, join = st_within) %&gt;%\n  filter(!is.na(median_income))\n\n#garage dummy\nopa_census &lt;- opa_census %&gt;%\n  mutate(\n    has_garage = if_else(!is.na(garage_spaces) & garage_spaces &gt; 0, 1L, 0L)\n  )\n\n\n\n\n\n\n\nCode\n# Original data dimensions\nopa_dims &lt;- tibble(\n  dataset = \"opa (raw CSV)\",\n  rows = nrow(opa),\n  columns = ncol(opa)\n)\n\n# cleaned data dimensions\nopa_filter_dims &lt;- tibble(\n  dataset = \"opa (filtered)\",\n  rows = nrow(opa_clean),\n  columns = ncol(opa_clean)\n)\nopa_selected_dims &lt;- tibble(\n  dataset = \"opa (cleaned & selected)\",\n  rows = nrow(opa_selected),\n  columns = ncol(opa_selected)\n)\n# data dimensions (within census tracts)\nopa_census_dims &lt;- tibble(\n  dataset = \"opa (spatial joined)\",\n  rows = nrow(opa_census),\n  columns = ncol(opa_census)\n)\n\n# create summary table\nsummary_table &lt;- bind_rows(opa_dims, opa_filter_dims,opa_selected_dims, opa_census_dims)\nsummary_table %&gt;%\n  kable(caption = \"Summary of OPA data before and after cleaning\")\n\n\n\nSummary of OPA data before and after cleaning\n\n\ndataset\nrows\ncolumns\n\n\n\n\nopa (raw CSV)\n583776\n79\n\n\nopa (filtered)\n42383\n79\n\n\nopa (cleaned & selected)\n25860\n23\n\n\nopa (spatial joined)\n25585\n35\n\n\n\n\n\n\n\nCode\n# load the neighborhood data by ward\nwards &lt;- st_read(\"data/Political_Wards.geojson\", quiet = TRUE) %&gt;%\n  st_transform(st_crs(opa_census))\n\n\n\n\n\nDuring the data preparation phase, several cleaning and filtering steps were performed to ensure the reliability of the Philadelphia property sales dataset.\n\nFiltering and selecting relevant variables\nOnly single-family residential properties were retained to maintain consistency in property type. Sales were limited to 2023–2024 to focus on the most recent housing market conditions.A subset of relevant columns—such as property characteristics, sale price, and geographic information—was retained to reduce processing time and support exploratory analysis.\nRemoving obvious errors and handling missing values\nExtremely low sale prices—often suspected to be due to inheritance transfers—were excluded to avoid biasing the model. Properties with a reported construction year of “0” were also removed, as these are unrealistic. Similarly, properties with nonpositive living area were excluded, since living area must be greater than zero.\nTransforming to spatial format and calculating additional attributes\nThe cleaned dataset was then converted to an sf (spatial features) object to enable spatial analysis. An additional variable, house age, was calculated based on the difference between the sale year and the year built, allowing for further filtering of unrealistic building ages and facilitating later modeling steps.\nIntegrating census and spatial amenity data\nCensus tract–level socioeconomic data were obtained via the tidycensus package and spatially joined to the property dataset using st_within(). This ensured that only properties located within the official boundaries of Philadelphia were retained. Additional contextual datasets from OpenDataPhilly (e.g., parks, schools, and public facilities)—were also prepared in phase 3 for subsequent analysis to examine how neighborhood characteristics may influence property prices.\nFinal dataset summary\nThrough this cleaning and integration process, the dataset was reduced from 583,776 initial records to 42,383 after initial filtering, and then to 25,860 after further refinement. Following the spatial join with census tract data, the final analytical dataset contained 25,585 valid property records with complete socioeconomic and spatial information."
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-2-exploratory-data-analysis",
    "href": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-2-exploratory-data-analysis",
    "title": "Philadelphia Housing Model",
    "section": "Phase 2: Exploratory Data Analysis",
    "text": "Phase 2: Exploratory Data Analysis\n\n1. Distribution of sale prices (histogram)\n\n\nCode\np_raw &lt;- ggplot(opa_var, aes(x = sale_price)) +\n  geom_histogram(bins = 50, fill = \"hotpink\", color = \"black\") +\n  geom_vline(aes(xintercept = median(sale_price)), linetype = \"dashed\") +\n  labs(title = \"Raw Distribution\",\n       x = \"Sale Price\", y = \"Count\") +\n  scale_x_continuous(labels = scales::label_dollar())\np_cut &lt;- opa_census %&gt;%\n  ggplot(aes(x = sale_price)) +\n  geom_histogram(bins = 50, fill = \"skyblue\", color = \"black\") +\n  geom_vline(aes(xintercept = median(sale_price)), linetype = \"dashed\") +\n  labs(title = \"Trimmed Distribution (selected)\",\n       x = \"Sale Price\", y = \"Count\") +\n  scale_x_continuous(labels = scales::label_dollar())\n  \np_raw/p_cut\n\n\n\n\n\n\n\n\n\nInterpretation\nThe first histogram shows the raw distribution of property sale prices in Philadelphia (2023–2024). Despite using 50 bins, the distribution remains highly right-skewed, with the vast majority of transactions concentrated below roughly $1.5 million and a small number of luxury properties extending far beyond that range. To address this heavy right tail, we trimmed observations above the 98th percentile of sale prices. This cutoff removes extreme luxury transactions that disproportionately influence the scale, while still preserving over 98% of the housing market.\nThe second histogram presents this trimmed distribution, excluding the top 2% of sales. After removing these extreme outliers, the shape becomes much clearer and more interpretable—revealing a unimodal, approximately log-normal pattern centered around the city’s median sale price.\n\n\n2. Geographic distribution (map)\n\n\nCode\nopa_census &lt;- opa_census %&gt;%\n  mutate(price_quartile = ntile(sale_price, 4))\n\nggplot() +\n  geom_sf(data = philly_census, fill = \"lightgrey\", color = \"white\") +\n  geom_sf(data = opa_census, aes(color = factor(price_quartile)), size = 0.1, alpha = 0.7) +\n  scale_color_viridis_d(\n    option = \"plasma\",\n    direction = -1,\n    labels = c(\"0%-25%\", \"25%-50%\", \"50%-75%\", \"75%-100%\")\n  ) +\n  theme_minimal() +\n  labs(\n    title = \"Housing Sales in Philadelphia (2023–2024)\",\n    color = \"Sale Price Quartile\"\n  )  +\n  guides(color = guide_legend(override.aes = list(size = 3)))\n\n\n\n\n\n\n\n\n\nInterpretation\nThe map shows a highly unequal distribution of housing prices across Philadelphia, clearly defined by geography.\nHighest Prices (Deep Purple: 75%-100%) are heavily clustered in the Northwest (affluent neighborhoods like Chestnut Hill) and the Central/Southeast Core (downtown luxury homes).\nLowest Prices (Bright Yellow: 0%-25%) dominate the Southwest portion of the city and parts of the far North/Northeast, indicating the most affordable markets.\nMid-Range Prices cover the majority of South Philadelphia and other areas surrounding the high-value core.\nIn short, wealth is concentrated in the Northwest and Center City, while affordability is highest in the Southwest.\n\n\n3. Price vs. structural features (scatter plots)\n\n\nCode\nggplot(opa_census, aes(x = total_livable_area, y = sale_price)) +\n  geom_point(alpha = 0.4, color=\"grey30\") +\n  geom_smooth(method = \"lm\", color = \"darkorange\") +\n  labs(title = \"Sale Price vs. Livable Area\",\n       x = \"Total Livable Area \", y = \"Sale Price\")\n\n\n\n\n\n\n\n\n\nInterpretation\nThe scatter plot above shows the relationship between total livable area and sale price for residential properties in Philadelphia (2023–2024).\nAs expected, larger homes generally sell for higher prices. However, there is also substantial variation among properties of similar size, reflecting the influence of location, building condition, and neighborhood characteristics.\nOverall, this visualization confirms that livable area is positively associated with sale price, though it is not the only factor shaping property values across the city.\n\n\n4. Price vs. spatial features (scatter plots)\n\n\nCode\ncrime &lt;- read_csv(\"data/crime.csv\") %&gt;% \n  filter(!is.na(lat) & !is.na(lng)) \ncrime_sf &lt;- st_as_sf(crime, coords = c(\"lng\", \"lat\"), crs = 4326) %&gt;%\n  st_transform(st_crs(opa_census)) \nradius_cri &lt;- 400 \nopa_census$crime_count &lt;- lengths(st_is_within_distance(opa_census, crime_sf, dist = radius_cri)) \n\nggplot(opa_census %&gt;% st_drop_geometry(),\n       aes(x = crime_count, y = sale_price)) +\n  geom_point(alpha = 0.3, color = \"grey60\", size = 1) +\n  geom_smooth(method = \"lm\", color = \"darkorange\", linewidth = 1.2, se = FALSE) +\n  scale_y_continuous(labels = label_dollar()) +\n  labs(\n    title = \"Relationship Between Nearby Crime and Home Sale Price\",\n    subtitle = \"Each point represents a residential property (400m radius crime count)\",\n    x = \"Number of Crimes within 400m\",\n    y = \"Sale Price\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    axis.text = element_text(color = \"grey30\"),\n    axis.title = element_text(color = \"grey20\")\n  )\n\n\n\n\n\n\n\n\n\nCode\nopa_interact &lt;- opa_census %&gt;%\n  st_drop_geometry() %&gt;%\n  mutate(\n    unemp_group = ntile(unemployment_rate, 2),\n    unemp_group = factor(unemp_group,\n                         labels = c(\"Low Unemployment\", \"High Unemployment\"))\n  )\n\nggplot(opa_interact, aes(x = crime_count, y = sale_price, color = unemp_group)) +\n  geom_point(alpha = 0.25, size = 0.8) +\n  geom_smooth(method = \"lm\", se = FALSE, linewidth = 1.2) +\n  scale_y_continuous(labels = label_dollar()) +\n  scale_color_viridis_d(option = \"plasma\", direction = -1) +\n  labs(\n    title = \"Interaction: Crime × Unemployment Level\",\n    subtitle = \"Crime has a stronger negative effect in high-unemployment neighborhoods\",\n    x = \"Number of Crimes within 400m\",\n    y = \"Sale Price\",\n    color = \"Unemployment Group\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"top\",\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank()\n  )\n\n\n\n\n\n\n\n\n\nInterpretation\nThe first chart shows a pattern in which housing prices fall as nearby crime incidents increase. The second chart shows a situation where high-unemployment areas experience steeper price declines, which means that economic disadvantage amplifies the effect of crime on housing markets.\n\n\n5. One creative visualization\n\n\nCode\nggplot(opa_census %&gt;% st_drop_geometry(),\n       aes(x = house_age, y = sale_price)) +\n  geom_point(alpha = 0.3, color = \"grey60\") +\n  geom_smooth(method = \"loess\", color = \"darkorange\", linewidth = 1.2, se = FALSE) +\n  labs(\n    title = \"House age vs. Sale Price\",\n    x = \"House age\",\n    y = \"Sale Price\"\n  ) +\n  theme_minimal(base_size = 12)\n\n\n\n\n\n\n\n\n\nInterpretation\nThe chart shows a nonlinear pattern where newer houses sell at higher prices, mid-aged houses experience lower values, and vintage and historical houses regain value due to historic character and prime urban locations."
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-3-feature-engineering-technical-appendix",
    "href": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-3-feature-engineering-technical-appendix",
    "title": "Philadelphia Housing Model",
    "section": "Phase 3: Feature Engineering (Technical Appendix)",
    "text": "Phase 3: Feature Engineering (Technical Appendix)\n\n1. Buffer-based features\n\n\nCode\n# Load transit stop data and create buffer-based feature\nTransit &lt;- read_csv(\"data/Transit.csv\")\ntransit_sf &lt;- st_as_sf(Transit, coords = c(\"Lon\", \"Lat\"), crs = 4326) %&gt;%\n  st_transform(st_crs(opa_census))\nradius &lt;- 400\nopa_census$transit_count &lt;- lengths(st_is_within_distance(opa_census, transit_sf, dist = radius))\n\n\n\n\nCode\n# add recreation and parks, create buffer (whithin walking distance)\nrecreation &lt;- read_csv(\"data/recreation.csv\") \nrecreation_sf &lt;- st_as_sf(recreation, coords = c(\"X\", \"Y\"), crs = 4326) %&gt;% st_transform(st_crs(opa_census)) \nradius_rec &lt;- 1200 \nopa_census$recreation_count &lt;- lengths(st_is_within_distance(opa_census, recreation_sf, dist = radius_rec)) \n\n# recreation dummy 0, 1-3, 4-9, 10+\nopa_census$recreation_dummy &lt;- case_when(\n  opa_census$recreation_count == 0 ~ \"None\",\n  opa_census$recreation_count &gt;= 1 & opa_census$recreation_count &lt;= 3 ~ \"Low\",\n  opa_census$recreation_count &gt;= 4 & opa_census$recreation_count &lt;= 8 ~ \"Medium\",\n  opa_census$recreation_count &gt;= 9 ~ \"High\"\n)\n\n\n\n\nCode\n#add center city as a dummy\ncenter_city &lt;- st_read(\"data/CCD_BOUNDARY.geojson\", quiet = TRUE) %&gt;%\n  st_transform(st_crs(opa_census))\n\nopa_census$center_city_dummy &lt;- as.numeric(\n  lengths(st_intersects(opa_census, center_city)) &gt; 0\n)\n\n\n\n\n2. k-Nearest Neighbor features\n\n\nCode\n# find the distance of the nearest hospital\nhospital_sf &lt;- st_read(\"data/hospitals.geojson\", quiet = TRUE) %&gt;%\n  st_transform(st_crs(opa_census))\n\nnearest_hospital_index &lt;- st_nearest_feature(opa_census, hospital_sf)\n\nopa_census$nearest_hospital_m &lt;- st_distance(\n  opa_census,\n  hospital_sf[nearest_hospital_index, ],\n  by_element = TRUE\n)\n\nopa_census$nearest_hospital_m &lt;- as.numeric(opa_census$nearest_hospital_m)\n\n\n\n\n3. Summary table of features\n\n\nCode\nspatial_summary &lt;- opa_census %&gt;%\n  st_drop_geometry() %&gt;%\n  dplyr::select(crime_count, transit_count, recreation_count, nearest_hospital_m) %&gt;%\n  summarise(\n    across(\n      everything(),\n      list(\n        mean = ~mean(., na.rm = TRUE),\n        median = ~median(., na.rm = TRUE),\n        sd = ~sd(., na.rm = TRUE),\n        min = ~min(., na.rm = TRUE),\n        max = ~max(., na.rm = TRUE)\n      )\n    )\n  ) %&gt;%\n  pivot_longer(\n    cols = everything(),\n    names_to = c(\"variable\", \"stat\"),\n    names_pattern = \"(.*)_(mean|median|sd|min|max)\"\n  ) %&gt;%\n  pivot_wider(names_from = stat, values_from = value) %&gt;%\n  mutate(across(where(is.numeric), ~round(., 2)))\n\nkable(spatial_summary, caption = \"Spatial Summary Statistics\")\n\n\n\nSpatial Summary Statistics\n\n\nvariable\nmean\nmedian\nsd\nmin\nmax\n\n\n\n\ncrime_count\n419.43\n399.00\n289.38\n0.00\n2639.00\n\n\ntransit_count\n29.50\n25.00\n21.96\n0.00\n216.00\n\n\nrecreation_count\n3.52\n3.00\n2.24\n0.00\n14.00\n\n\nnearest_hospital_m\n1794.15\n1607.44\n1015.42\n43.12\n5395.42\n\n\n\n\n\n\n\nCode\n# Dummy variable count summary\ndummy_summary &lt;- opa_census %&gt;%\n  st_drop_geometry() %&gt;%\n  dplyr::select(recreation_dummy, center_city_dummy) %&gt;%\n  summarise(across(\n    everything(),\n    ~ paste0(names(table(.)), \": \", as.numeric(table(.))) %&gt;%\n      paste(collapse = \"; \")\n  )) %&gt;%\n  pivot_longer(cols = everything(),\n               names_to = \"variable\",\n               values_to = \"count_distribution\")\n\nkable(dummy_summary, caption = \"Dummy Summary Statistics\")\n\n\n\nDummy Summary Statistics\n\n\nvariable\ncount_distribution\n\n\n\n\nrecreation_dummy\nHigh: 823; Low: 12889; Medium: 10774; None: 1099\n\n\ncenter_city_dummy\n0: 25295; 1: 290\n\n\n\n\n\ninterpretation\n\n\n\n\n\n\n\n\nFeature\nType\nDescription\n\n\n\n\ncrime_count\nnumeric\nNumber of reported crimes within census boundary\n\n\ntransit_count\nnumeric\nTransit stops within 400 m\n\n\nrecreation_dummy\ncategorical\nAccessibility: None / Low / Medium / High\n\n\nnearest_hospital_m\nnumeric\nDistance to nearest hospital (meters)\n\n\ncenter_city_dummy\nbinary\n1 = within Center City District\n\n\n\n\n\n4. Narrative Explaining Feature Engineering\nDuring the feature engineering phase, a series of spatial indicators were developed to capture neighborhood-level conditions relevant to property values across Philadelphia.\n\nCreating buffer-based accessibility features\nTransit stops within a 400 m radius were counted for each property to represent public transport accessibility, a key component of urban connectivity. Recreation facilities within 1.2 km were used to approximate walkable access to amenities under the “15-minute city” concept, which reflects daily life convenience and potentially higher demand in middle- and high-income areas. A categorical variable of recreations was created to classify accessibility as None, Low, Medium, or High.\nAdding location dummies and urban core identification\nA binary indicator identified whether a property lies within Philadelphia’s Center City boundary. This variable captures the premium effect of the city’s dense commercial and employment core, where housing demand remains consistently high.\nIncorporating nearest-neighbor proximity features\nThe shortest distance to hospitals was calculated using the k-nearest neighbor approach to represent healthcare accessibility."
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-4-model-building",
    "href": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-4-model-building",
    "title": "Philadelphia Housing Model",
    "section": "Phase 4: Model Building",
    "text": "Phase 4: Model Building\n\n1. Structural features only\nThis baseline model focuses on property-level characteristics to explain price variation. It includes size, number of bedrooms and bathrooms, and building age (with a quadratic term to capture nonlinear aging effects).\n\n\nCode\nmodel1 &lt;- lm(sale_price ~ total_livable_area + number_of_bedrooms +\n               number_of_bathrooms + house_age + I(house_age^2),\n             data = opa_census)\nsummary(model1)\n\n\n\nCall:\nlm(formula = sale_price ~ total_livable_area + number_of_bedrooms + \n    number_of_bathrooms + house_age + I(house_age^2), data = opa_census)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1849632   -93819   -16892    62981  1166739 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)          2.200e+05  5.906e+03   37.24   &lt;2e-16 ***\ntotal_livable_area   1.598e+02  2.205e+00   72.47   &lt;2e-16 ***\nnumber_of_bedrooms  -3.337e+04  1.200e+03  -27.79   &lt;2e-16 ***\nnumber_of_bathrooms  9.263e+04  1.804e+03   51.34   &lt;2e-16 ***\nhouse_age           -4.486e+03  1.135e+02  -39.52   &lt;2e-16 ***\nI(house_age^2)       2.442e+01  7.249e-01   33.69   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 153500 on 24683 degrees of freedom\n  (896 observations deleted due to missingness)\nMultiple R-squared:  0.4497,    Adjusted R-squared:  0.4496 \nF-statistic:  4034 on 5 and 24683 DF,  p-value: &lt; 2.2e-16\n\n\nThe model shows that larger homes and those with more bathrooms tend to sell for higher prices, while having more bedrooms (holding size constant) slightly reduces value, likely because it implies smaller rooms. Older houses are generally less expensive, but the positive squared term for house age suggests that this decline slows over time—very old or historic homes may retain or regain value. Overall, the model explains about 45% of the variation in sale prices, indicating a reasonably strong fit.\n\n\n2.Census variables\nThis model incorporates neighborhood socioeconomic factors drawn from Census data. Variables such as median income, education level (BA rate), unemployment, and racial composition, which introduce the broader census data context into the housing price model.\n\n\nCode\nmodel2 &lt;- lm(sale_price ~ total_livable_area + number_of_bedrooms +\n               number_of_bathrooms + house_age + I(house_age^2) +\n               median_income + ba_rate + log(unemployment_rate+1) + black_share,\n             data = opa_census)\nsummary(model2)\n\n\n\nCall:\nlm(formula = sale_price ~ total_livable_area + number_of_bedrooms + \n    number_of_bathrooms + house_age + I(house_age^2) + median_income + \n    ba_rate + log(unemployment_rate + 1) + black_share, data = opa_census)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1494787   -67062   -10215    44754  1241464 \n\nCoefficients:\n                             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 2.185e+04  7.125e+03   3.067  0.00217 ** \ntotal_livable_area          1.402e+02  1.891e+00  74.151  &lt; 2e-16 ***\nnumber_of_bedrooms         -6.128e+03  1.059e+03  -5.786 7.29e-09 ***\nnumber_of_bathrooms         6.144e+04  1.569e+03  39.162  &lt; 2e-16 ***\nhouse_age                  -1.999e+03  1.010e+02 -19.788  &lt; 2e-16 ***\nI(house_age^2)              9.349e+00  6.492e-01  14.401  &lt; 2e-16 ***\nmedian_income               1.250e+00  4.665e-02  26.785  &lt; 2e-16 ***\nba_rate                     3.007e+03  1.181e+02  25.462  &lt; 2e-16 ***\nlog(unemployment_rate + 1) -9.702e+03  1.595e+03  -6.082 1.21e-09 ***\nblack_share                -6.888e+02  3.168e+01 -21.742  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 130400 on 24679 degrees of freedom\n  (896 observations deleted due to missingness)\nMultiple R-squared:  0.603, Adjusted R-squared:  0.6029 \nF-statistic:  4166 on 9 and 24679 DF,  p-value: &lt; 2.2e-16\n\n\nCompared with the first model, this version explains more variation in sale prices (R² rises from 0.45 to 0.60). Structural effects remain similar: larger area and more bathrooms increase value, while older homes are cheaper but the decline slows with age. Adding neighborhood factors improves accuracy—homes in areas with higher income and education levels sell for more, while higher unemployment and larger Black population shares correspond to lower prices. This shows that both property traits and local socioeconomic context shape housing values.\n\n\n3. Spatial features\nThis step adds spatial variables to capture location effects in prices and to improve prediction. We include crime count as safety, transit stops within 400 m as mobility access, recreation within 1.2 km as amenity access, and hospital distance as service access.\n\n\nCode\nmodel3 &lt;- lm(sale_price ~ total_livable_area + number_of_bedrooms +\n               number_of_bathrooms + house_age + I(house_age^2) +\n               median_income + ba_rate + log(unemployment_rate+1) + black_share +\n               crime_count + I(crime_count^2) + \n               transit_count + recreation_count + nearest_hospital_m + I(nearest_hospital_m^2),\n             data = opa_census)\nsummary(model3)\n\n\n\nCall:\nlm(formula = sale_price ~ total_livable_area + number_of_bedrooms + \n    number_of_bathrooms + house_age + I(house_age^2) + median_income + \n    ba_rate + log(unemployment_rate + 1) + black_share + crime_count + \n    I(crime_count^2) + transit_count + recreation_count + nearest_hospital_m + \n    I(nearest_hospital_m^2), data = opa_census)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1527075   -66187    -9409    45418  1231837 \n\nCoefficients:\n                             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 5.774e+04  8.421e+03   6.857 7.18e-12 ***\ntotal_livable_area          1.422e+02  1.898e+00  74.923  &lt; 2e-16 ***\nnumber_of_bedrooms         -5.084e+03  1.062e+03  -4.786 1.71e-06 ***\nnumber_of_bathrooms         5.992e+04  1.563e+03  38.348  &lt; 2e-16 ***\nhouse_age                  -2.037e+03  1.020e+02 -19.972  &lt; 2e-16 ***\nI(house_age^2)              9.206e+00  6.680e-01  13.781  &lt; 2e-16 ***\nmedian_income               1.258e+00  4.712e-02  26.691  &lt; 2e-16 ***\nba_rate                     2.314e+03  1.236e+02  18.727  &lt; 2e-16 ***\nlog(unemployment_rate + 1) -1.272e+04  1.613e+03  -7.886 3.25e-15 ***\nblack_share                -5.942e+02  3.287e+01 -18.076  &lt; 2e-16 ***\ncrime_count                -7.525e+00  8.146e+00  -0.924  0.35559    \nI(crime_count^2)           -1.342e-02  4.434e-03  -3.028  0.00247 ** \ntransit_count               4.535e+02  4.542e+01   9.985  &lt; 2e-16 ***\nrecreation_count            3.766e+03  4.445e+02   8.473  &lt; 2e-16 ***\nnearest_hospital_m         -4.081e+01  3.321e+00 -12.287  &lt; 2e-16 ***\nI(nearest_hospital_m^2)     8.112e-03  7.117e-04  11.398  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 129400 on 24673 degrees of freedom\n  (896 observations deleted due to missingness)\nMultiple R-squared:  0.6092,    Adjusted R-squared:  0.6089 \nF-statistic:  2564 on 15 and 24673 DF,  p-value: &lt; 2.2e-16\n\n\nThis third model adds spatial accessibility and amenity variables on top of housing and neighborhood characteristics. The explanatory power improves slightly (R² rises from 0.60 to 0.61). Core structural effects remain consistent: larger homes and more bathrooms raise prices, while older homes are cheaper but depreciate more slowly with age.\nAmong the new variables, transit access and recreation facilities show strong positive effects—areas with better public transport and more recreation sites have higher housing values. Proximity to hospitals also matters: prices fall as distance increases, but the positive squared term suggests diminishing marginal effects once the hospital is very close. Crime count is mostly insignificant, implying limited direct influence after controlling for other neighborhood factors.\n\n\n4. Interactions and fixed effects\nThis final model adds interaction and dummy variables to capture more detailed relationships. The interaction term between crime count and unemployment rate examines how the effect of crime varies with local economic conditions. Dummy variables identify categorical differences: has_garage explains the house stucture, center_city_dummy represents the city core premium, and recreation_dummy classifies recreational access levels.\n\n\nCode\nmodel4 &lt;- lm(sale_price ~ total_livable_area + number_of_bedrooms +number_of_bathrooms +\n               house_age + I(house_age^2) +\n               median_income + ba_rate + crime_count*unemployment_rate + black_share + \n               has_garage + center_city_dummy + recreation_dummy + \n               transit_count + nearest_hospital_m + I(nearest_hospital_m^2),\n             data = opa_census)\nsummary(model4)\n\n\n\nCall:\nlm(formula = sale_price ~ total_livable_area + number_of_bedrooms + \n    number_of_bathrooms + house_age + I(house_age^2) + median_income + \n    ba_rate + crime_count * unemployment_rate + black_share + \n    has_garage + center_city_dummy + recreation_dummy + transit_count + \n    nearest_hospital_m + I(nearest_hospital_m^2), data = opa_census)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1483816   -65681   -10090    44396  1232825 \n\nCoefficients:\n                                Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                    1.121e+05  9.380e+03  11.951  &lt; 2e-16 ***\ntotal_livable_area             1.398e+02  1.898e+00  73.628  &lt; 2e-16 ***\nnumber_of_bedrooms            -4.858e+03  1.065e+03  -4.561 5.11e-06 ***\nnumber_of_bathrooms            5.975e+04  1.563e+03  38.237  &lt; 2e-16 ***\nhouse_age                     -2.139e+03  1.015e+02 -21.065  &lt; 2e-16 ***\nI(house_age^2)                 1.053e+01  6.654e-01  15.828  &lt; 2e-16 ***\nmedian_income                  1.259e+00  4.633e-02  27.173  &lt; 2e-16 ***\nba_rate                        2.406e+03  1.248e+02  19.273  &lt; 2e-16 ***\ncrime_count                   -4.881e+01  5.850e+00  -8.343  &lt; 2e-16 ***\nunemployment_rate             -3.039e+03  3.326e+02  -9.136  &lt; 2e-16 ***\nblack_share                   -5.554e+02  3.257e+01 -17.056  &lt; 2e-16 ***\nhas_garage                     2.167e+04  2.065e+03  10.494  &lt; 2e-16 ***\ncenter_city_dummy              3.268e+04  9.776e+03   3.343 0.000831 ***\nrecreation_dummyLow           -5.425e+04  4.947e+03 -10.967  &lt; 2e-16 ***\nrecreation_dummyMedium        -4.568e+04  4.897e+03  -9.327  &lt; 2e-16 ***\nrecreation_dummyNone          -7.618e+04  6.353e+03 -11.990  &lt; 2e-16 ***\ntransit_count                  4.257e+02  4.729e+01   9.002  &lt; 2e-16 ***\nnearest_hospital_m            -4.213e+01  3.313e+00 -12.717  &lt; 2e-16 ***\nI(nearest_hospital_m^2)        8.235e-03  7.092e-04  11.611  &lt; 2e-16 ***\ncrime_count:unemployment_rate  4.012e+00  5.686e-01   7.056 1.76e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 129000 on 24669 degrees of freedom\n  (896 observations deleted due to missingness)\nMultiple R-squared:  0.6117,    Adjusted R-squared:  0.6114 \nF-statistic:  2045 on 19 and 24669 DF,  p-value: &lt; 2.2e-16\n\n\nThis final model adds categorical variables and an interaction between crime and unemployment to capture contextual effects. The fit improves slightly again (R² ≈ 0.61). Structural patterns remain stable: larger and newer homes with more bathrooms are worth more, and aging reduces value but at a slowing rate.\nNeighborhood effects also stay consistent—higher income and education raise prices, while higher unemployment and larger Black population shares lower them. In areas with higher unemployment, housing prices are less sensitive to crime; in contrast, in areas with lower unemployment and stronger economic conditions, crime has a larger negative impact on housing values.\nAdding location and amenity dummies refines spatial interpretation. Properties in Center City and those with garages sell for more, while areas with fewer recreation facilities are valued lower. Proximity to hospitals and transit access continue to show positive associations with housing value."
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-5-model-validation",
    "href": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-5-model-validation",
    "title": "Philadelphia Housing Model",
    "section": "Phase 5: Model Validation",
    "text": "Phase 5: Model Validation\n\n1. Use 10-fold cross-validation\n\n\nCode\nmodel_data &lt;- opa_census %&gt;%\n  st_drop_geometry() %&gt;%\n  dplyr::select(\n    sale_price, total_livable_area, number_of_bedrooms,\n    number_of_bathrooms, house_age,\n    median_income, ba_rate, unemployment_rate, black_share,\n    crime_count, transit_count, recreation_count, recreation_dummy,\n    nearest_hospital_m, center_city_dummy, has_garage\n  ) %&gt;%\n  filter(complete.cases(.))\n\n\n\n\nCode\nfml1 &lt;- sale_price ~\n  total_livable_area + number_of_bedrooms +\n  number_of_bathrooms + house_age + I(house_age^2)\n\nfml2 &lt;- sale_price ~\n  total_livable_area + number_of_bedrooms +\n  number_of_bathrooms + house_age + I(house_age^2) + \n  median_income + ba_rate + log(unemployment_rate + 1) + black_share\n\nfml3 &lt;- sale_price ~ total_livable_area + number_of_bedrooms +\n  number_of_bathrooms + house_age + I(house_age^2) +\n  median_income + ba_rate + log(unemployment_rate+1) + black_share +\n  crime_count + I(crime_count^2) + \n  transit_count + recreation_count + nearest_hospital_m + I(nearest_hospital_m^2)\n\nfml4 &lt;- sale_price ~ \n  total_livable_area + number_of_bedrooms +\n  number_of_bathrooms + house_age + I(house_age^2) +\n  median_income + ba_rate + crime_count*unemployment_rate + black_share + \n  has_garage + center_city_dummy + recreation_dummy +\n  transit_count + nearest_hospital_m + I(nearest_hospital_m^2)\n\n\n\n\nCode\nset.seed(42)\ncv_control &lt;- trainControl(method = \"cv\", number = 10, savePredictions = \"final\")\n\nm1 &lt;- train(fml1, data = model_data, method = \"lm\", trControl = cv_control)\nm2 &lt;- train(fml2, data = model_data, method = \"lm\", trControl = cv_control)\nm3 &lt;- train(fml3, data = model_data, method = \"lm\", trControl = cv_control)\nm4 &lt;- train(fml4, data = model_data, method = \"lm\", trControl = cv_control)\n\n\nThis section evaluates model performance using 10-fold cross-validation to ensure generalizability. The dataset was split into ten equal subsets: in each iteration, nine folds trained the model while the remaining one tested it. This process repeated ten times so every observation served once as validation data. The caret::train() function handled resampling automatically through trainControl(method = “cv”, number = 10), producing stable estimates of RMSE, MAE, and R² for each model specification.\n\n\nCode\nresults &lt;- resamples(list(\n  Model1 = m1, Model2 = m2, Model3 = m3, Model4 = m4\n))\nsummary(results)\n\n\n\nCall:\nsummary.resamples(object = results)\n\nModels: Model1, Model2, Model3, Model4 \nNumber of resamples: 10 \n\nMAE \n            Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's\nModel1 103832.37 105851.22 106517.63 106328.38 106921.93 108152.06    0\nModel2  79425.48  81272.40  81915.61  82093.29  82932.69  86451.81    0\nModel3  77409.32  79949.03  81598.75  81708.58  84257.63  85577.85    0\nModel4  78644.93  80083.13  80844.30  81139.03  82327.48  83757.55    0\n\nRMSE \n           Min.  1st Qu.   Median     Mean  3rd Qu.     Max. NA's\nModel1 145350.1 152411.8 153331.8 153662.0 156080.2 159735.1    0\nModel2 122545.9 125892.2 129781.0 130385.0 133188.4 141634.3    0\nModel3 117575.6 121104.8 131024.7 129307.9 136081.8 142036.6    0\nModel4 119231.8 126158.4 127392.3 129018.7 130930.4 139698.6    0\n\nRsquared \n            Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's\nModel1 0.4136413 0.4421692 0.4515556 0.4497851 0.4556238 0.4862556    0\nModel2 0.5605534 0.5835312 0.6031830 0.6033292 0.6258022 0.6362505    0\nModel3 0.5374865 0.5799484 0.6114265 0.6099480 0.6449153 0.6753661    0\nModel4 0.5748278 0.5996610 0.6132781 0.6116480 0.6262643 0.6538824    0\n\n\n\n\nCode\n# Cross-validation average metrics\nmodel_results &lt;- tibble(\n  Model = c(\"Model 1: Structural Only\", \n            \"Model 2: + Census Variables\", \n            \"Model 3: + Spatial Features\", \n            \"Model 4: + Interactions and Fixed Effects\"),\n  MAE = c(106328, 82093, 81709, 81139),\n  RMSE = c(153662, 130385, 129308, 129019),\n  R2 = c(0.450, 0.603, 0.610, 0.612)\n)\n\nmodel_results %&gt;%\n  gt() %&gt;%\n  fmt_number(columns = c(MAE, RMSE), decimals = 0) %&gt;%\n  fmt_number(columns = R2, decimals = 3) %&gt;%\n  tab_header(\n    title = \"Model Performance (10-Fold Cross Validation)\",\n    subtitle = \"Average metrics across resamples\"\n  ) %&gt;%\n  cols_label(\n    Model = \"Model Specification\",\n    MAE = \"Mean Absolute Error ($)\",\n    RMSE = \"Root Mean Squared Error ($)\",\n    R2 = \"R²\"\n  )\n\n\n\n\n\n\n\n\nModel Performance (10-Fold Cross Validation)\n\n\nAverage metrics across resamples\n\n\nModel Specification\nMean Absolute Error ($)\nRoot Mean Squared Error ($)\nR²\n\n\n\n\nModel 1: Structural Only\n106,328\n153,662\n0.450\n\n\nModel 2: + Census Variables\n82,093\n130,385\n0.603\n\n\nModel 3: + Spatial Features\n81,709\n129,308\n0.610\n\n\nModel 4: + Interactions and Fixed Effects\n81,139\n129,019\n0.612\n\n\n\n\n\n\n\nThe 10-fold cross-validation results show steady improvement as more variables are added. The structural model explains about 45% of price variation, while adding census data raises accuracy to 60%. Including spatial features gives small but consistent gains, and the final model with interaction and fixed-effect terms reaches the best overall performance (MAE ≈ $81K; RMSE ≈ $129K; R² = 0.61), showing that it captures most location and neighborhood effects on housing prices.\n\n\n2. Predicted vs. Actual Plot for First Model and Final Model\n\n\nCode\nplot_df1 &lt;- opa_census %&gt;%\n  mutate(\n    pred = predict(model1, newdata = opa_census),\n    obs = sale_price\n  ) %&gt;%\n  dplyr::select(pred, obs)\n\nplot_df4 &lt;- opa_census %&gt;%\n  mutate(\n    pred = predict(model4, newdata = opa_census),\n    obs = sale_price\n  ) %&gt;%\n  dplyr::select(pred, obs)\n\nrmse1 &lt;- 153662   # Model 1 RMSE\nr21   &lt;- 0.45     # Model 1 R²\nrmse4 &lt;- 129019   # Model 4 RMSE\nr24   &lt;- 0.61     # Model 4 R²\n\np1 &lt;- ggplot(plot_df1, aes(x = pred, y = obs)) +\n  geom_point(alpha = 0.3, color = \"#E69F00\") +\n  geom_abline(slope = 1, intercept = 0, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Model 1\",\n    subtitle = paste0(\"RMSE = \", scales::comma(rmse1), \n                      \", R² = \", round(r21, 2))\n  ) +\n  theme_minimal() +\n  coord_fixed()\n\n\np4 &lt;- ggplot(plot_df4, aes(x = pred, y = obs)) +\n  geom_point(alpha = 0.3, color = \"#4682B4\") +\n  geom_abline(slope = 1, intercept = 0, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Model 4\",\n    subtitle = paste0(\"RMSE = \", scales::comma(rmse4), \n                      \", R² = \", round(r24, 2))\n  ) +\n  theme_minimal() +\n  coord_fixed()\n\np1 + p4 +\n  plot_annotation(\n    title = \"Predicted vs. Actual Sale Prices\",\n    subtitle = \"Comparison between Model 1 and Model 4\",\n    theme = theme(plot.title = element_text(size = 16, face = \"bold\"),\n                  plot.subtitle = element_text(size = 12))\n  )\n\n\n\n\n\n\n\n\n\nModel 4 demonstrates a noticeably better fit than Model 1, with predicted values more tightly clustered around the 45-degree line. The improvement reflects how adding census, spatial, and interaction terms enhances the model’s ability to capture neighborhood-level variation in housing prices. Residual dispersion decreases, though some bias persists at the extremes: high-value properties tend to be slightly underestimated, while low-value ones are sometimes overpredicted. These patterns are common in real-world housing data, where non-market transactions, inheritances, or atypical sales fall outside the scope of typical market dynamics.\n\n\n3. top 5 predictors visualization\n\n\nCode\nmodel4_std &lt;- lm.beta(model4)\n\ncoef_std &lt;- broom::tidy(model4_std) %&gt;%\n  filter(term != \"(Intercept)\") %&gt;%\n  mutate(Standardized = model4_std$standardized.coefficients[term])\n\ntop5_std &lt;- coef_std %&gt;%\n  arrange(desc(abs(Standardized))) %&gt;%\n  slice(1:10)\n\nkable(\n  top5_std %&gt;%\n    dplyr::select(term, estimate, Standardized, std.error, statistic, p.value) %&gt;%\n    mutate(across(where(is.numeric), ~ round(., 3))),\n  caption = \"Top 10 Standardized Coefficients from Model 4\"\n)\n\n\n\nTop 10 Standardized Coefficients from Model 4\n\n\n\n\n\n\n\n\n\n\nterm\nestimate\nStandardized\nstd.error\nstatistic\np.value\n\n\n\n\ntotal_livable_area\n139.756\n0.353\n1.898\n73.628\n0\n\n\nhouse_age\n-2138.542\n-0.319\n101.520\n-21.065\n0\n\n\nI(house_age^2)\n10.533\n0.236\n0.665\n15.828\n0\n\n\nnearest_hospital_m\n-42.134\n-0.207\n3.313\n-12.717\n0\n\n\nnumber_of_bathrooms\n59752.834\n0.200\n1562.682\n38.237\n0\n\n\nmedian_income\n1.259\n0.195\n0.046\n27.173\n0\n\n\nI(nearest_hospital_m^2)\n0.008\n0.181\n0.001\n11.611\n0\n\n\nba_rate\n2405.764\n0.143\n124.828\n19.273\n0\n\n\nrecreation_dummyLow\n-54254.808\n-0.131\n4947.201\n-10.967\n0\n\n\nrecreation_dummyMedium\n-45676.480\n-0.109\n4897.261\n-9.327\n0\n\n\n\n\n\n\n\nCode\ntop5_std %&gt;%\n  mutate(term = reorder(term, abs(Standardized))) %&gt;%\n  ggplot(aes(x = term, y = Standardized, fill = Standardized &gt; 0)) +\n  geom_col(width = 0.6, show.legend = FALSE) +\n  coord_flip() +\n  geom_text(aes(label = round(Standardized, 3)),\n            hjust = ifelse(top5_std$Standardized &gt; 0, -0.1, 1.1),\n            size = 3.8) +\n  scale_fill_manual(values = c(\"skyblue\", \"hotpink\")) +\n  labs(\n    title = \"Top 10 Standardized Coefficients from Model 4\",\n    x = \"\",\n    y = \"Standardized Coefficient (β)\"\n  ) +\n  theme_minimal(base_size = 13) +\n  geom_hline(yintercept = 0, color = \"black\", linewidth = 0.8) +\n  expand_limits(y = c(-max(abs(top5_std$Standardized)) * 1.2, \n                      max(abs(top5_std$Standardized)) * 1.2)) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5),\n    panel.grid.minor = element_blank()\n  )\n\n\n\n\n\n\n\n\n\nThe standardized coefficients show which variables have the strongest relative influence on housing prices after accounting for differences in measurement units. Total livable area has the largest positive effect, meaning larger homes consistently sell for more. House age shows the strongest negative relationship—older properties tend to be less valuable—but the positive squared term indicates that this decline slows with age. Proximity to hospitals also matters: homes closer to medical facilities are priced higher, while distance reduces value. Among neighborhood and amenity factors, higher education levels (BA rate) and income raise prices, whereas limited recreational access slightly lowers them."
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-6-model-diagnostics",
    "href": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-6-model-diagnostics",
    "title": "Philadelphia Housing Model",
    "section": "Phase 6: Model Diagnostics",
    "text": "Phase 6: Model Diagnostics\n\n1. residual plot, QQ plot, Cook’s distance\n\n\nCode\npar(mfrow = c(1, 1))\n\n# 1. Residuals vs Fitted\nplot(model4, which = 1, main = \"Residuals vs Fitted\")\n\n\n\n\n\n\n\n\n\nCode\n# 2. Normal Q-Q\nplot(model4, which = 2, main = \"Q-Q Plot\")\n\n\n\n\n\n\n\n\n\nCode\n# 3. Cook’s distance\nplot(model4, which = 4, main = \"Cook’s Distance\")\n\n\n\n\n\n\n\n\n\nThe residuals vs. fitted plot shows a roughly symmetric spread around zero but with noticeable heteroscedasticity—larger variance among high-priced properties, showing that extreme prices remain difficult to predict precisely. The Q–Q plot indicates some heavy tails and outliers. In real-world housing data, perfect normality and constant variance are rarely achievable, so these deviations remain within a reasonable range for practical modeling.\nThe Cook’s Distance plot further supports this assessment. Most observations exert minimal influence on the fitted model, though a few high-leverage points stand out. These likely correspond to unusually expensive or unique properties that differ substantially from the bulk of the dataset. While such influential cases can slightly affect coefficient estimates, their limited number suggests that the overall model remains stable and reliable.\n\n\n2. Mean Residual by Neighborhood\n\n\nCode\nopa_census$pred_price &lt;- predict(model4, newdata = opa_census)\n\nopa_ward &lt;- st_join(opa_census, wards[\"ward_num\"])\n\nward_summary &lt;- opa_ward %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(ward_num) %&gt;%\n  summarise(\n    mean_actual = mean(sale_price, na.rm = TRUE),\n    mean_pred = mean(pred_price, na.rm = TRUE),\n    median_pred = median(pred_price, na.rm = TRUE),\n    n_properties = n()\n  ) %&gt;%\n  mutate(residual_mean = mean_actual - mean_pred) %&gt;% \n  arrange(desc(residual_mean))\n\nhead(ward_summary)\n\n\n# A tibble: 6 × 6\n  ward_num mean_actual mean_pred median_pred n_properties residual_mean\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;        &lt;int&gt;         &lt;dbl&gt;\n1 30           640680.   485118.     479847.          505       155562.\n2 9            626051.   499829.     464823.          217       126222.\n3 14           422417.   343372.     295923.           51        79044.\n4 8            484681.   405894.     397665.          593        78787.\n5 27           403270.   335831.     311875.           93        67439.\n6 2            558185.   503658.     488557.          563        54527.\n\n\n\n\nCode\nward_plot_data &lt;- wards %&gt;%\n  left_join(ward_summary, by = \"ward_num\")\n\nggplot(ward_plot_data) +\n  geom_sf(aes(fill = residual_mean), color = \"white\", size = 0.2) +\n  scale_fill_gradient2(\n    low = \"#4575B4\",\n    mid = \"white\",\n    high = \"#D73027\",\n    midpoint = 0,\n    labels = scales::label_dollar()\n  ) +\n  labs(\n    title = \"Mean Prediction Residuals by Ward\",\n    subtitle = \"Positive = Underestimation | Negative = Overestimation\",\n    fill = \"Actual - Predicted\"\n  ) +\n  theme_minimal(base_size = 11) +\n  theme(\n    axis.text = element_blank(),\n    axis.ticks = element_blank(),\n    panel.grid = element_blank()\n  )"
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-7-conclusions-recommendations",
    "href": "Projects/Philadelphia Housing Model/Philadelphia-Housing-Model.html#phase-7-conclusions-recommendations",
    "title": "Philadelphia Housing Model",
    "section": "Phase 7: Conclusions & Recommendations",
    "text": "Phase 7: Conclusions & Recommendations\nThis project predicts housing sale prices in Philadelphia and shows that structural inequality in the city is spatially organized, with high-value neighborhoods concentrated in the central, northeast, and northwestern parts, and lower-value areas clustered in the north and west.\nThe model shows that actual sale prices in high-value neighborhoods are consistently higher than predicted, while those in lower-income and high-unemployment areas tend to be slightly lower than predicted. This residual pattern indicates a potential bias in the city’s property assessment system, where wealthier neighborhoods may be undertaxed and disadvantaged ones overtaxed.\nIn neighborhoods with high unemployment and crime, the model shows that housing markets no longer respond to safety improvements. Simply adding policing or security programs does not raise property values because the underlying economic conditions remain weak. For safety investments to be effective, policies should focus on rebuilding the local economic base by expanding job opportunities, supporting small businesses, and improving public infrastructure to make these neighborhoods worth to invest.\nThe model primarily captures spatial variation but performs less accurately for properties with sale prices above one million dollars. Some public datasets contain missing or inconsistent records, which may introduce minor systematic bias. Future research should integrate temporal dynamics and machine learning methods to better predict properties at both the lower and upper ends of the sale price distribution.\nTo promote spatial equity, policy should expand affordable and mixed-income housing in high-value districts through inclusionary zoning and other incentives, while improving transit, recreational spaces, and essential urban amenities—such as schools, healthcare facilities, and public services—in underserved neighborhoods, so that opportunity and growth are not confined to a few areas."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "",
    "text": "In the NFIRS (National Fire Incident Reporting System) reporting system, false alarms (codes 700–799) include system malfunctions, unintentional activations, detector errors, and malicious alarms. Although no actual fire is present, each false alarm still triggers a full fire department response.\nIn OpenDataPhilly dataset, 77% of all fire-related incidents are false alarms. This extremely high share creates substantial operational burden: every response requires multiple firefighters, apparatus deployment, fuel and equipment usage, and temporarily removes units from availability for real emergencies.\nReducing false alarms can save time, reduce firefighter workload, and improve public safety. This analysis produces a predicted probability of false alarm for each incident.\nBy choosing an appropriate threshold, the city can identify high-risk cases and apply targeted interventions to reduce unnecessary responses and operational costs."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#setup",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#setup",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "2.1 Setup",
    "text": "2.1 Setup\n\n\nCode\n# Core packages\nlibrary(tidyverse)   # dplyr, ggplot2, readr, tidyr, stringr, etc.\nlibrary(sf)\nlibrary(tigris)\nlibrary(tidycensus)\n\n# Modeling / utilities\nlibrary(MASS)\nlibrary(caret)\nlibrary(broom)\nlibrary(patchwork)\nlibrary(scales)\nlibrary(knitr)\nlibrary(riem)\nlibrary(dplyr)\nlibrary(pROC)\nlibrary(tidyr)\nlibrary(lubridate)\n\n# tigris options\noptions(tigris_use_cache = TRUE, tigris_class = \"sf\", tigris_progress = FALSE)\n\n# set a global theme\ntheme_set(theme_minimal(base_size = 12))"
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#data-import-cleaning",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#data-import-cleaning",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "2.2 Data Import & Cleaning",
    "text": "2.2 Data Import & Cleaning\n\n2.2.1 Fire Incident Data\nWe recoded incident types following NFIRS conventions. All 7xx incidents represent False Alarm & False Call responses (e.g., alarm system malfunctions, detector errors, accidental activations, and malicious alarms) and were coded as 1. Incidents in the 1xx and 2xx series correspond to actual fires and overpressure/explosion events that required genuine emergency response; these were coded as 0. This classification provides a clean separation between false alarms and all non–false alarm incidents for modeling purposes.\n\n\nCode\nfire &lt;- st_read(\"data/stat360/stat360_fire_incidents.shp\", quiet = TRUE)\nsort(table(fire$incident_2), decreasing = TRUE)[1:20]\n\nfire &lt;- fire |&gt;\n  filter(!sf::st_is_empty(geometry)) |&gt;\n  mutate(\n    incident_code = as.integer(str_extract(incident_1, \"^\\\\d+\"))\n  ) |&gt;\n  filter(incident_code %in% c(1L, 7L)) |&gt;\n  mutate(\n    inc_new = if_else(incident_code == 7L, 1L, 0L)\n  )\n\nfire |&gt;\n  st_drop_geometry() |&gt;\n  count(inc_new) |&gt;\n  mutate(p = n / sum(n)) |&gt;\n  knitr::kable(digits = 3)\n\n\n\n\n2.2.2 Census Data\nWe retrieved tract-level demographic and socioeconomic indicators from the 2023 American Community Survey (ACS) to incorporate neighborhood characteristics that may influence false-alarm patterns. Prior research shows that alarm activity often correlates with community demographics, housing conditions, and economic stressors. Accordingly, we included measures of population composition, educational attainment, income, and labor force status to capture these broader social determinants.\n\n\nCode\nphilly_census &lt;- get_acs(\ngeography = \"tract\",\nvariables = c(\ntotal_pop = \"B01003_001\",\nblack = \"B02001_003\",\nba_degree = \"B15003_022\",\ntotal_edu = \"B15003_001\",\nmedian_income = \"B19013_001\",\nlabor_force = \"B23025_003\",\nunemployed = \"B23025_005\"\n),\nyear = 2023,\nstate = \"PA\",\ncounty = \"Philadelphia\",\ngeometry = TRUE\n) |&gt;\ndplyr::select(GEOID, variable, estimate, geometry) |&gt;\ntidyr::pivot_wider(names_from = variable, values_from = estimate) |&gt;\ndplyr::mutate(\nba_rate = 100 * ba_degree / total_edu,\nunemployment_rate = 100 * unemployed / labor_force,\nblack_share = 100 * black / total_pop\n) |&gt;\nst_transform(st_crs(fire))\n\n\n\n\n2.2.3 Fire Alarm Data\nBuilding certification information comes from the City of Philadelphia’s Licenses and Inspections (L&I) Building Certifications dataset on OpenDataPhilly. We joined these records to the building footprints to identify each building’s fire-alarm certification status (Active, Expired, or Deficient). Including this information allows the model to account for building-level inspection and maintenance conditions, which are closely related to false-alarm occurrences.\n\n\nCode\nbldg_foot &lt;- st_read(\"data/LI_BUILDING_FOOTPRINTS.shp\", quiet = TRUE)\ncert_sum &lt;- readr::read_csv(\"data/BUILDING_CERT_SUMMARY.csv\", show_col_types = FALSE)\n\nbldg_cert &lt;- bldg_foot |&gt;\n  mutate(bin = as.character(bin)) |&gt;\n  inner_join(\n    cert_sum |&gt;\n      mutate(structure_id = as.character(structure_id)),\n    by = c(\"bin\" = \"structure_id\")\n  )\n\nbldg_cert |&gt;\n  st_drop_geometry() |&gt;\n  summarise(n_bldg = n_distinct(bin))\n\n\n  n_bldg\n1  26310\n\n\nCode\nbldg_cert |&gt;\n  st_drop_geometry() |&gt;\n  count(fire_alarm_status, sort = TRUE)\n\n\n  fire_alarm_status     n\n1            Active 13241\n2           Expired  7635\n3              &lt;NA&gt;  5098\n4         Deficient   340\n\n\nWe spatially joined the building certification records to census tracts to summarize inspection conditions at the neighborhood level. For each tract, we calculated the number of buildings with Active, Expired, or Deficient fire-alarm certifications and derived an active certification rate. These tract-level indicators were then merged into the ACS dataset, allowing the model to incorporate variation in building inspection status across neighborhoods.\n\n\nCode\nbldg_tract &lt;- bldg_cert |&gt;\nst_transform(st_crs(philly_census)) |&gt;\nst_join(philly_census[\"GEOID\"])\n\ntract_alarm &lt;- bldg_tract |&gt;\nst_drop_geometry() |&gt;\ngroup_by(GEOID) |&gt;\nsummarise(\nn_bldg = n(),\nn_active = sum(fire_alarm_status == \"Active\", na.rm = TRUE),\nn_expired = sum(fire_alarm_status == \"Expired\", na.rm = TRUE),\nn_deficient= sum(fire_alarm_status == \"Deficient\", na.rm = TRUE),\nactive_rate = n_active / n_bldg\n)\n\nphilly_census_alarm &lt;- philly_census |&gt;\nleft_join(tract_alarm, by = \"GEOID\")\n\n\n\n\n2.2.4 Weather Data\nWe obtained hourly weather observations from the PHL airport weather station using the riem_measures API. Data were downloaded in several date ranges and combined into a single dataset, from which duplicate timestamps were removed. Including weather information allows the model to capture environmental conditions such as temperature, precipitation, and wind speed that may influence alarm activations and false-alarm likelihood.\n\n\nCode\nget_phl &lt;- function(start, end) \n  riem_measures(\n    station     = \"PHL\",\n    date_start  = start,\n    date_end    = end,\n    report_type = c(\"routine\", \"specials\", \"hfmetar\")\n  )\n\nw1 &lt;- get_phl(\"2024-01-01\", \"2024-03-31\")\nw2 &lt;- get_phl(\"2024-04-01\", \"2024-06-30\")\nw3 &lt;- get_phl(\"2024-07-01\", \"2024-09-30\")\nw4 &lt;- get_phl(\"2024-10-01\", \"2024-12-31\")\nw5 &lt;- get_phl(\"2025-01-01\", \"2025-06-30\")\nw6 &lt;- get_phl(\"2025-07-01\", \"2025-10-06\")\n\nweather_data &lt;- bind_rows(w1, w2, w3, w4, w5, w6) |&gt;\n  arrange(valid) |&gt;\n  distinct(valid, .keep_all = TRUE)\n\nrange(weather_data$valid)\n\n\n[1] \"2024-01-01 00:00:00 UTC\" \"2025-10-05 23:55:00 UTC\"\n\n\nCode\nnrow(weather_data)\n\n\n[1] 196666\n\n\n\n\nCode\nweather_processed &lt;- weather_data %&gt;%\n  dplyr::mutate(\n    interval60    = floor_date(valid, unit = \"hour\"),\n    Temperature   = tmpf,\n    Precipitation = ifelse(is.na(p01i), 0, p01i),\n    Wind_Speed    = sknt\n  ) %&gt;%\n  dplyr::select(interval60, Temperature, Precipitation, Wind_Speed) %&gt;%\n  dplyr::distinct()\n\nweather_complete &lt;- weather_processed %&gt;%\n  tidyr::complete(\n    interval60 = seq(min(interval60), max(interval60), by = \"hour\")\n  ) %&gt;%\n  tidyr::fill(Temperature, Precipitation, Wind_Speed, .direction = \"down\") %&gt;%\n  dplyr::filter(lubridate::hour(interval60) == 12) %&gt;%\n  dplyr::arrange(interval60) %&gt;%\n  dplyr::mutate(date = as.Date(interval60)) %&gt;%\n  dplyr::group_by(date) %&gt;%\n  dplyr::slice(1) %&gt;%\n  dplyr::ungroup() %&gt;%\n  dplyr::select(date, Temperature, Precipitation, Wind_Speed)\n\nweather_complete$Precipitation &lt;- weather_complete$Precipitation + 0.00001\n\n\n\n\n2.2.5 Work Days and Weekends\nFrom the cleaned weather dataset, we generated a day-of-week variable and an is_weekend flag to capture weekly temporal patterns in alarm activity. Weekend versus weekday distinctions are included because building use and human activity differ substantially across the week. On weekends, many commercial and institutional buildings operate at reduced occupancy, while residential buildings experience increased activity. These shifts can influence how alarm systems behave through factors such as maintenance schedules, system testing times, building vacancy, cooking activity, or nuisance triggers.\n\n\nCode\nweather_daily &lt;- weather_complete %&gt;%\n  dplyr::mutate(\n    dow        = lubridate::wday(date, label = TRUE, week_start = 1),\n    is_weekend = as.integer(dow %in% c(\"Sat\", \"Sun\"))   # 0 = weekday, 1 = weekend\n  )\n\nweather_daily %&gt;%\n  dplyr::count(is_weekend)\n\n\n# A tibble: 2 × 2\n  is_weekend     n\n       &lt;int&gt; &lt;int&gt;\n1          0   460\n2          1   184\n\n\n\n\n2.2.6 Location of Fire Stations\nWe incorporated the locations of Philadelphia fire stations by converting the Fire_Dept table into a spatial dataset using station latitude and longitude. A 100-meter buffer was generated around each station to capture buildings located very close to fire infrastructure. Proximity to a fire station may relate to false-alarm activity, for example, areas near stations may include larger commercial buildings with more alarm systems, more frequent maintenance activity, or higher reporting sensitivity."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#data-merge",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#data-merge",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "2.3 Data Merge",
    "text": "2.3 Data Merge\nMultiple contextual variables were merged onto the incident dataset to create a comprehensive analytic file. Weather observations were linked by date, fire station buffers were used to generate a proximity indicator, and incidents were spatially joined to census tracts to attach neighborhood socioeconomic and building-inspection attributes. We also derived temporal structure by assigning each incident to a calendar quarter, and calculated the distance from each incident to Philadelphia City Hall as a simple measure of urban centrality. Together, these additions introduce temporal, spatial, and neighborhood-level variation that may influence false-alarm patterns.\n\n2.3.1 Join Daily Weather to Fire Incidents\n\n\nCode\nfire_weather &lt;- fire %&gt;%\n  dplyr::mutate(\n    date = as.Date(alarm_date)  \n  ) %&gt;%\n  dplyr::left_join(\n    weather_daily,\n    by = \"date\"\n  )\n\n\n\n\n2.3.2 Join the Fire Station Buffer\n\n\nCode\nfire_weather_station &lt;- fire_weather |&gt;\n  st_transform(st_crs(firesta_buf))\n\nidx &lt;- st_intersects(fire_weather_station, firesta_buf)  \n\nfire_weather_station &lt;- fire_weather_station |&gt;\n  mutate(\n    near_station_200m = as.integer(lengths(idx) &gt; 0) \n  )\n\n\n\n\n2.3.3 Combine with Census Tract Data\n\n\nCode\nphilly_census_alarm &lt;- philly_census_alarm |&gt;\nst_transform(st_crs(fire_weather_station))\n\n\n\n\nCode\nfire_firetract &lt;- fire_weather_station |&gt;\nst_join(\nphilly_census_alarm,\njoin = st_within, \nleft = TRUE\n)\n\n\n\n\n2.3.4 Create Quarter Column\n\n\nCode\nfire_firetract &lt;- fire_firetract |&gt;\ndplyr::mutate(\nquarter_num = lubridate::quarter(date), # 1–4\nquarter = factor(quarter_num,\nlevels = 1:4,\nlabels = c(\"Q1\", \"Q2\", \"Q3\", \"Q4\"))\n)\n\n\n\n\n2.3.5 Distance to City Hall\n\n\nCode\ndowntown &lt;- tribble(\n  ~name, ~lat,       ~lon,\n  \"Philadelphia City Hall (Downtown)\", 39.952583, -75.165222\n) %&gt;%\n  st_as_sf(coords = c(\"lon\",\"lat\"), crs = 4326, remove = FALSE)\n\nn &lt;- nrow(fire_firetract)\n\nfire_firetract &lt;- fire_firetract |&gt;\n  st_transform(st_crs(downtown)) |&gt;\n  mutate(\n    dist_cityhall_m = as.numeric(\n      st_distance(\n        geometry,\n        st_geometry(downtown)[rep(1, n)],\n        by_element = TRUE\n      )\n    ),\n    dist_cityhall_km = dist_cityhall_m / 1000\n  )"
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#map-false-alarm-rate-by-census-tract",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#map-false-alarm-rate-by-census-tract",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "3.1 Map: False Alarm Rate by Census Tract",
    "text": "3.1 Map: False Alarm Rate by Census Tract\n\n\nCode\ntract_fire_stats &lt;- fire_firetract |&gt;\nst_drop_geometry() |&gt;\ndplyr::filter(!is.na(GEOID)) |&gt;\ndplyr::group_by(GEOID) |&gt;\ndplyr::summarise(\nn_incidents  = dplyr::n(),\nn_false_7   = sum(inc_new == 1, na.rm = TRUE),\nfalse_rate_7 = n_false_7 / n_incidents\n)\n\nphilly_census_alarm_fire &lt;- philly_census_alarm |&gt;\ndplyr::left_join(tract_fire_stats, by = \"GEOID\")\n\nggplot(philly_census_alarm_fire) +\n  geom_sf(aes(fill = false_rate_7), color = NA) +\n  scale_fill_viridis_c(\n    option   = \"magma\",\n    direction = -1,\n    na.value = \"grey90\",\n    labels   = scales::percent_format(accuracy = 1),\n    name     = \"False alarm rate\\n(inc_67 share)\"\n  ) +\n  labs(\n    title    = \"False Alarm Rate of Fire Incidents by Census Tract\",\n    subtitle = \"Share of incidents with primary code 7\",\n    caption  = \"Tracts with no incidents shown in grey.\"\n  ) +\n  theme_void() +                        \n  theme(\n    legend.position = \"right\",\n    plot.title      = element_text(face = \"bold\")\n  )\n\n\n\n\n\n\n\n\n\nInterpretation\nThis map shows the spatial distribution of false alarms across Philadelphia census tracts. Each tract is shaded according to the share of incidents classified as false alarms (primary code 7). Darker purple areas represent neighborhoods where false alarms make up a larger proportion of fire responses, while lighter areas exhibit lower false-alarm activity. Tracts with no recorded incidents during the study period are shown in grey. The pattern highlights substantial geographic variation: several central and high-density neighborhoods display elevated false-alarm rates, whereas some peripheral areas show relatively fewer false responses."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#pie-chart-true-fire-vs-false-alarm",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#pie-chart-true-fire-vs-false-alarm",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "3.2 Pie Chart: True Fire vs False Alarm",
    "text": "3.2 Pie Chart: True Fire vs False Alarm\n\n\nCode\nggplot(binary_summary, aes(x = \"\", y = p, fill = fire_type)) +\n  geom_col(width = 1, color = \"white\") +\n  geom_text(\n    aes(label = p_label),\n    position = position_stack(vjust = 0.5),\n    size = 4\n  ) +\n  coord_polar(theta = \"y\") +\n  scale_fill_manual(\n    values = c(\n      \"True Fire\"   = \"lightblue\",\n      \"False Alarm\" = \"hotpink\"\n    )\n  ) +\n  labs(\n    title = \"True Fire vs False Alarm Incidents\",\n    fill  = \"Incident Type\"\n  ) +\n  theme_void() +\n  theme(\n    plot.title = element_text(\n      hjust = 0.5,\n      size = 14,\n      face = \"bold\"\n    )\n  )\n\n\n\n\n\n\n\n\n\nInterpretation\nThe pie chart summarizes the composition of all fire-related incidents in Philadelphia during the study period. False alarms account for 77% of all dispatches, while true fire events represent only 23%. This large imbalance highlights a central operational challenge for the Fire Department: the vast majority of responses do not involve an actual fire, yet still require staff time, equipment movement, and system capacity. The high prevalence of false alarms underscores the importance of predictive modeling to help identify where and when such calls are most likely to occur."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#line-chart-false-alarm-rate-by-quarter",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#line-chart-false-alarm-rate-by-quarter",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "3.3 Line Chart: False Alarm Rate by Quarter",
    "text": "3.3 Line Chart: False Alarm Rate by Quarter\n\n\nCode\nquarter_stats &lt;- fire_firetract |&gt;\n  sf::st_drop_geometry() |&gt;\n  dplyr::filter(!is.na(quarter)) |&gt;\n  dplyr::group_by(quarter) |&gt;\n  dplyr::summarise(\n    n_incidents  = dplyr::n(),\n    false_rate_7 = mean(inc_new == 1, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\nggplot(quarter_stats, aes(x = quarter, y = false_rate_7, group = 1)) +\n  geom_line(color = \"hotpink\", size = 1.4) +           \n  geom_point(color = \"hotpink\", size = 3.8) +             \n  geom_text(\n    aes(label = percent(false_rate_7, accuracy = 1)),\n    vjust = -0.6,\n    size = 4,\n    color = \"#2c3e50\"                   \n  ) +\n  scale_y_continuous(\n    labels = percent_format(),\n    limits = c(0.70, 0.84)              \n  ) +\n  labs(\n    title = \"City-wide False Alarm Rate by Quarter\",\n    x = \"Quarter\",\n    y = \"False Alarm Rate\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title = element_text(size = 15, face = \"bold\", hjust = 0.5),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    axis.text.x = element_text(face = \"bold\")\n  )\n\n\n\n\n\n\n\n\n\nInterpretation\nThe quarterly trend shows modest but consistent seasonal variation in Philadelphia’s false alarm rate. Rates rise from 75% in Q1 to a peak of 81% in Q3, before dropping to 73% in Q4. This pattern suggests that false alarms become slightly more common during the summer months and decline toward the end of the year. Although the seasonal differences are not dramatic, they highlight that false alarm activity is not evenly distributed across the calendar, which may have implications for staffing, resource planning, and inspection scheduling."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#map-expired-alarm-certificates-share-by-census-tract",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#map-expired-alarm-certificates-share-by-census-tract",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "3.4 Map: Expired Alarm Certificates Share by Census Tract",
    "text": "3.4 Map: Expired Alarm Certificates Share by Census Tract\n\n\nCode\nbldg_cert_flag &lt;- bldg_cert |&gt;\n  filter(!is.na(fire_alarm_status)) |&gt;\n  mutate(\n    alarm_expired = case_when(\n      fire_alarm_status == \"Expired\" ~ 1L,\n      fire_alarm_status %in% c(\"Active\", \"Deficient\") ~ 0L,\n      TRUE ~ NA_integer_\n    )\n  )\n\nbldg_cert_flag &lt;- st_transform(bldg_cert_flag, st_crs(philly_census))\n\nbldg_tract &lt;- st_join(\n  bldg_cert_flag,\n  philly_census |&gt; dplyr::select(GEOID),\n  left = FALSE\n)\n\ntract_expired &lt;- bldg_tract |&gt;\n  st_drop_geometry() |&gt;\n  filter(!is.na(alarm_expired)) |&gt;\n  group_by(GEOID) |&gt;\n  summarise(\n    n_bldg_cert  = n(),\n    expired_share = mean(alarm_expired),\n    .groups = \"drop\"\n  )\n\n\n\n\nCode\ntract_map &lt;- philly_census_alarm |&gt;\n  dplyr::left_join(tract_expired, by = \"GEOID\")\n\nggplot(tract_map) +\n  geom_sf(aes(fill = expired_share), color = NA) +\n  scale_fill_viridis_c(\n    option = \"magma\",\n    direction = -1,\n    labels = percent_format(accuracy = 1),\n    na.value = \"grey90\"\n  ) +\n  labs(\n    title = \"Expired Alarm Certificates Share\",\n    fill  = \"Expired Share\"\n  ) +\n  coord_sf(datum = NA) + \n  theme_minimal(base_size = 13) +\n   theme(\n    plot.title      = element_text(face = \"bold\", hjust = 0.5, margin = margin(b = 10)),\n    axis.text       = element_blank(),\n    axis.title      = element_blank(),\n    axis.ticks      = element_blank(),\n    panel.grid      = element_blank(),\n    panel.background = element_rect(fill = \"white\", color = NA),\n    plot.margin     = margin(10, 10, 10, 10)\n  )\n\n\n\n\n\n\n\n\n\nInterpretation\nThis map illustrates the share of buildings with expired fire alarm certifications across Philadelphia census tracts. Higher-expiry areas (shaded in darker purple) appear in several parts of North and West Philadelphia, as well as pockets of the Northeast. These neighborhoods tend to show a larger proportion of buildings whose annual alarm inspections are overdue, signaling potential maintenance challenges or compliance gaps. In contrast, many tracts in Center City and portions of South Philadelphia display lower expired shares, suggesting stronger inspection adherence. The geographic pattern indicates that certification compliance is not uniform across the city and may align with broader socioeconomic differences, telling us areas where targeted outreach or enforcement may be most needed."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#model1-weather-data",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#model1-weather-data",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "4.1 Model1: Weather Data",
    "text": "4.1 Model1: Weather Data\nModel 1 is a baseline logistic regression that predicts whether an incident is a false alarm (inc_new = 1) using only weather conditions and building-level activity rates on the day of the call. The model includes:\n\nTemperature: Daily average temperature\nPrecipitation: Total daily precipitation\nWind_Speed: Average daily wind speed\nactive_rate: Share of buildings in the tract with an active (valid) fire alarm certification\n\n\n\nCode\nlogit_model1 &lt;- glm(\n  inc_new ~ Temperature + Precipitation + Wind_Speed + active_rate,\n  data   = fire_firetract,\n  family = binomial(link = \"logit\")\n)\n\n\n\n\n\nLogistic Regression Model: Weather Predictors Only\n\n\nVariable\nEstimate\nStd. Error\nz value\nPr(&gt;|z|)\n\n\n\n\n(Intercept)\n0.5846\n0.0536\n10.91\n0.000000\n\n\nTemperature\n0.0101\n0.0005\n18.64\n0.000000\n\n\nPrecipitation\n18.5156\n5.0734\n3.65\n0.000263\n\n\nWind_Speed\n0.0034\n0.0023\n1.44\n0.151000\n\n\nactive_rate\n0.1182\n0.0810\n1.46\n0.145000\n\n\n\n\n\nLogit Model 1 serves as the baseline specification, incorporating only weather variables and the building-level alarm compliance rate to predict whether an incident is a false alarm. The model’s estimates indicate statistically significant effects for temperature and precipitation, suggesting that warmer days and days with measurable precipitation are associated with a higher likelihood of false alarms. In contrast, wind speed and the active certification rate do not reach conventional significance levels in this simplified model. Overall model fit is modest, with limited explanatory power relative to later specifications that incorporate socioeconomic, spatial, and temporal predictors. As expected for a parsimonious model, it captures only a small share of the variation in incident outcomes and primarily functions as a reference point against which the performance gains of more complete models can be assessed."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#model-2-socioeconomic",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#model-2-socioeconomic",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "4.2 Model 2: Socioeconomic",
    "text": "4.2 Model 2: Socioeconomic\nModel 2 extends the baseline specification by incorporating census tract–level socioeconomic characteristics to capture structural factors that may influence false alarm patterns. In addition to the weather variables and active building certification rates from Model 1, this model includes:\n\nmedian_income: Median household income, reflecting economic resources and potential differences in building conditions. 232qq\nba_rate: Share of adults holding a bachelor’s degree, used as a proxy for neighborhood socio-demographic composition.\nblack_share: Percentage of Black residents in the tract, capturing racial composition patterns relevant for equity analysis.\nunemployment_rate: Local unemployment levels, which may correlate with neighborhood stressors or reporting behaviors.\n\nThese variables allow the model to account for broader socioeconomic context rather than relying solely on incident-day environmental factors.\n\n\nCode\nlogit_model2 &lt;- glm(\n  inc_new ~ Temperature + Precipitation + Wind_Speed + active_rate +\n    median_income + ba_rate + black_share + unemployment_rate,\n  data   = fire_firetract,\n  family = binomial(link = \"logit\")\n)\n\n\n\n\n\nLogit Model 2: With Socioeconomic Predictors\n\n\nVariable\nEstimate\nStd. Error\nz value\nPr(&gt;|z|)\n\n\n\n\n(Intercept)\n-1.4270\n0.0740\n-19.29\n0.00e+00\n\n\nTemperature\n0.0091\n0.0006\n15.87\n0.00e+00\n\n\nPrecipitation\n18.3240\n5.2965\n3.46\n5.41e-04\n\n\nWind_Speed\n0.0039\n0.0025\n1.57\n1.16e-01\n\n\nactive_rate\n0.4680\n0.0888\n5.27\n1.00e-07\n\n\nmedian_income\n0.0000\n0.0000\n5.10\n3.00e-07\n\n\nba_rate\n0.0554\n0.0013\n43.32\n0.00e+00\n\n\nblack_share\n0.0139\n0.0004\n36.52\n0.00e+00\n\n\nunemployment_rate\n0.0142\n0.0021\n6.91\n0.00e+00\n\n\n\n\n\nModel 2 expands the baseline specification by incorporating socioeconomic characteristics of each census tract, and its performance improves substantially relative to Model 1. Education level (ba_rate), Black population share, and median income are highly statistically significant, indicating that false alarm patterns are strongly associated with underlying demographic and socioeconomic conditions. The model’s coefficients suggest that areas with higher educational attainment and larger Black population shares exhibit higher probabilities of false alarms, even after controlling for weather and building-level compliance activity. Compared with the baseline model, the residual deviance decreases from 67133 to 59730 and the AIC drops from 67143 to 59748, indicating a markedly better fit. These gains show that socioeconomic context meaningfully contributes to predicting false alarms and helps explain variation that weather alone cannot."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#model-3-full-model",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#model-3-full-model",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "4.3 Model 3: Full Model",
    "text": "4.3 Model 3: Full Model\nModel 3 extends the previous specifications by incorporating temporal patterns and spatial accessibility factors that may influence the likelihood of a false alarm. In addition to weather, building characteristics, and neighborhood socioeconomic indicators, this model includes:\n\nis_weekend : Whether the incident occurred on a weekend, capturing changes in occupancy, human activity, and reporting behavior between weekdays and weekends.\nquarter: A categorical indicator for seasonal variation (Q1–Q4), allowing the model to account for cyclical patterns in alarm activity across the year.\nnear_station_200m: A binary variable identifying incidents that occur within 200 meters of a fire station, representing potential differences in response environments and built-environment characteristics around stations.\ndist_cityhall_km: The distance from the incident location to Philadelphia City Hall, serving as a proxy for urban centrality and potential differences between high-density downtown areas and more peripheral neighborhoods.\n\n\n\nCode\nlogit_model3 &lt;- glm(\n  inc_new ~ Temperature + Precipitation + Wind_Speed + active_rate +\n    median_income + ba_rate + black_share + unemployment_rate +\n    is_weekend + quarter + near_station_200m + dist_cityhall_km,\n  data   = fire_firetract,\n  family = binomial(link = \"logit\")\n)\n\n\n\n\n\nLogistic Regression Model: Full Model\n\n\nVariable\nEstimate\nStd. Error\nz value\nPr(&gt;|z|)\n\n\n\n\n(Intercept)\n-1.2325\n0.0810\n-15.21\n0.00e+00\n\n\nTemperature\n0.0072\n0.0010\n7.45\n0.00e+00\n\n\nPrecipitation\n17.4394\n5.2598\n3.32\n9.14e-04\n\n\nWind_Speed\n0.0041\n0.0025\n1.65\n9.92e-02\n\n\nactive_rate\n0.4676\n0.0888\n5.27\n1.00e-07\n\n\nmedian_income\n0.0000\n0.0000\n5.35\n1.00e-07\n\n\nba_rate\n0.0546\n0.0014\n39.33\n0.00e+00\n\n\nblack_share\n0.0138\n0.0004\n35.71\n0.00e+00\n\n\nunemployment_rate\n0.0137\n0.0021\n6.66\n0.00e+00\n\n\nis_weekend\n-0.0649\n0.0225\n-2.88\n3.92e-03\n\n\nquarterQ2\n-0.0305\n0.0369\n-0.83\n4.09e-01\n\n\nquarterQ3\n0.0838\n0.0441\n1.90\n5.76e-02\n\n\nquarterQ4\n-0.1713\n0.0313\n-5.47\n0.00e+00\n\n\nnear_station_200m\n-0.1063\n0.0308\n-3.45\n5.66e-04\n\n\ndist_cityhall_km\n-0.0044\n0.0022\n-1.98\n4.75e-02\n\n\n\n\n\nThe full model delivers the strongest predictive performance among the three specifications. Adding socioeconomic factors, temporal indicators, and spatial proximity variables substantially improves model fit, reducing deviance and lowering AIC compared to Models 1 and 2. Several predictors show significant associations with false-alarm likelihood, most notably education level, racial composition, unemployment rate, and building certification activity while weather variables retain moderate predictive power. Temporal effects are modest but present, with higher false-alarm rates in Q3 and lower rates in Q4. Spatial features contribute additional explanatory value, as calls nearer to fire stations and farther from Center City are slightly less likely to be false alarms. Overall, the full model captures the most complete set of behavioral, environmental, and geographic signals and therefore serves as the best-performing specification for subsequent interpretation and policy analysis."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#model-evaluation",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#model-evaluation",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "4.4 Model Evaluation",
    "text": "4.4 Model Evaluation\n\n4.4.1 AUC Comparison\n\n\nCode\ndat1 &lt;- model.frame(logit_model1) \np1   &lt;- predict(logit_model1, type = \"response\")\nroc1 &lt;- roc(dat1$inc_new, p1)\nauc1 &lt;- auc(roc1)\n\ndat2 &lt;- model.frame(logit_model2)\np2   &lt;- predict(logit_model2, type = \"response\")\nroc2 &lt;- roc(dat2$inc_new, p2)\nauc2 &lt;- auc(roc2)\n\ndat3 &lt;- model.frame(logit_model3)\np3   &lt;- predict(logit_model3, type = \"response\")\nroc3 &lt;- roc(dat3$inc_new, p3)\nauc3 &lt;- auc(roc3)\n\ndata.frame(\n  model = c(\"logit_model1\", \"logit_model2\", \"logit_model3\"),\n  AUC   = c(auc1, auc2, auc3)\n)\n\n\n         model       AUC\n1 logit_model1 0.5539505\n2 logit_model2 0.6703993\n3 logit_model3 0.6720569\n\n\nAcross the three logistic regression specifications, predictive performance improves steadily as additional structural, socioeconomic, and temporal features are introduced. Model 1 achieves an AUC of 0.554, indicating very limited predictive power and only marginal improvement over random guessing. Adding socioeconomic variables in Model 2 substantially increases the AUC to 0.670, suggesting that neighborhood‐level demographic and income patterns provide meaningful signal in distinguishing false alarms from true fire events. The full model (Model 3), which incorporates temporal indicators, proximity to fire stations, and distance to downtown, yields the highest AUC of 0.672. Although the improvement over Model 2 is modest, it indicates that these operational and spatial predictors add incremental information beyond weather and socioeconomic structure.\n\n\n4.4.2 ROC Curve\n\n\nCode\nplot(roc1, col = \"blue\", lwd = 2, main = \"ROC Curves for Logit Models\")\nplot(roc2, col = \"red\", lwd = 2, add = TRUE)\nplot(roc3, col = \"purple\", lwd = 2, add = TRUE)\nlegend(\"bottomright\",\n       legend = c(\"Model 1\", \"Model 2\", \"Model 3\"),\n       col    = c(\"blue\", \"red\", \"purple\"),\n       lwd    = 2)\n\n\n\n\n\n\n\n\n\nThe ROC curves visualize how each model balances sensitivity and specificity across all possible thresholds. Model 1 shows the weakest discrimination, with a curve only slightly above the 45-degree no-skill line. Model 2 improves substantially once socioeconomic characteristics are added, producing a visibly steeper curve. Model 3 offers a modest gain: adding temporal factors and spatial proximity variables produces the strongest curve overall, indicating the most consistent ability to distinguish false alarms from real incidents across thresholds.\n\n\n4.4.3 K-fold Cross Validation\n\n\nCode\nset.seed(123)\n\nfire_cv &lt;- fire_firetract |&gt;\n  sf::st_drop_geometry() |&gt;\n  dplyr::mutate(\n    y = ifelse(inc_new == 1, \"FalseAlarm\", \"RealIncident\"),\n    y = factor(y, levels = c(\"FalseAlarm\", \"RealIncident\"))\n  ) |&gt;\n  dplyr::select(\n    y,\n    Temperature, Precipitation, Wind_Speed, active_rate,\n    median_income, ba_rate, black_share, unemployment_rate,\n    is_weekend, quarter, near_station_200m, dist_cityhall_km\n  ) |&gt;\n  tidyr::drop_na()\n\ntrain_control &lt;- trainControl(\n  method = \"cv\",\n  number = 5,\n  classProbs = TRUE,\n  summaryFunction = twoClassSummary\n)\n\nlogit_cv_model &lt;- train(\n  y ~ .,\n  data      = fire_cv,\n  method    = \"glm\",\n  family    = binomial(link = \"logit\"),\n  trControl = train_control,\n  metric    = \"ROC\"\n)\n\nlogit_cv_model\n\n\nGeneralized Linear Model \n\n59340 samples\n   12 predictor\n    2 classes: 'FalseAlarm', 'RealIncident' \n\nNo pre-processing\nResampling: Cross-Validated (5 fold) \nSummary of sample sizes: 47472, 47473, 47471, 47472, 47472 \nResampling results:\n\n  ROC       Sens       Spec      \n  0.671565  0.9858302  0.06613265\n\n\nTo assess the stability of the full logistic regression model, we conduct 5-fold cross-validation on the training data. The cross-validated ROC (0.672) is nearly identical to the in-sample ROC reported earlier, indicating that the model’s predictive performance is highly stable across different data splits. The very high sensitivity and low specificity largely reflect the substantial class imbalance in the outcome (false alarms ≈ 77%). Because classification thresholds are not yet optimized at this stage, these values are not used for model selection; instead, cross-validation primarily confirms that the model generalizes consistently.\n\n\n4.4.4 Odds Ratios for Model 3\n\n\nCode\nor_table_simple &lt;- tidy(logit_model3) %&gt;%\n  mutate(\n    odds_ratio = round(exp(estimate), 3)\n  ) %&gt;%\n  dplyr::select(\n    Variable = term,\n    Odds_Ratio = odds_ratio\n  )\n\nkable(\n  or_table_simple,\n  caption = \"Odds Ratios for Logit Model 3\",\n  align = \"lr\"\n)\n\n\n\nOdds Ratios for Logit Model 3\n\n\nVariable\nOdds_Ratio\n\n\n\n\n(Intercept)\n0.292\n\n\nTemperature\n1.007\n\n\nPrecipitation\n37483869.597\n\n\nWind_Speed\n1.004\n\n\nactive_rate\n1.596\n\n\nmedian_income\n1.000\n\n\nba_rate\n1.056\n\n\nblack_share\n1.014\n\n\nunemployment_rate\n1.014\n\n\nis_weekend\n0.937\n\n\nquarterQ2\n0.970\n\n\nquarterQ3\n1.087\n\n\nquarterQ4\n0.843\n\n\nnear_station_200m\n0.899\n\n\ndist_cityhall_km\n0.996\n\n\n\n\n\nThe odds‐ratio table summarizes how each predictor influences the likelihood that an incident is classified as a false alarm after controlling for all other variables. Weather variables, particularly temperature and precipitation, remain strong predictors, with higher temperatures and any measurable precipitation increasing the likelihood of a false alarm. Building compliance also matters: tracts with higher active certification rates show significantly greater odds of false alarms, consistent with patterns observed in the earlier models. Socioeconomic context continues to contribute meaningful signal, higher educational attainment, a larger Black population share, and higher unemployment are all associated with elevated false-alarm odds, even after controlling for weather and temporal factors. Temporal features add smaller but still interpretable effects: false alarms are slightly less likely on weekends and in Q4, and marginally more likely in Q3. Finally, spatial accessibility plays a role: incidents occurring near a fire station (&lt;200m) or farther from Center City show modestly reduced odds of being false alarms. Together, these results suggest that false-alarm activity reflects an interaction of environmental conditions, neighborhood characteristics, and system operations."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#threshold-selection",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#threshold-selection",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "4.5 Threshold Selection",
    "text": "4.5 Threshold Selection\nIn a logistic regression model, predicted values represent the probability that an incident is a false alarm. To convert these probabilities into binary classifications (false alarm vs. real incident), a decision threshold must be chosen. Different thresholds produce different trade-offs between sensitivity (true positive rate) and specificity (true negative rate).\nWe evaluated two candidate thresholds—0.9 and 0.4—to illustrate how classification behavior changes under different risk tolerances.\n\n\nCode\nget_metrics &lt;- function(th) {\n  pred &lt;- ifelse(p3 &gt;= th, 1L, 0L)\n  cm   &lt;- table(Actual = dat3$inc_new, Pred = pred)\n\n  TN &lt;- cm[\"0\",\"0\"]; FP &lt;- cm[\"0\",\"1\"]\n  FN &lt;- cm[\"1\",\"0\"]; TP &lt;- cm[\"1\",\"1\"]\n\n  tibble(\n    threshold  = th,\n    TN  = as.numeric(TN),\n    FP  = as.numeric(FP),\n    FN  = as.numeric(FN),\n    TP  = as.numeric(TP),\n    accuracy   = (TP + TN) / sum(cm),\n    sensitivity = TP / (TP + FN), \n    specificity = TN / (TN + FP), \n    fpr        = FP / (FP + TN)   \n  )\n}\n\nmetrics &lt;- bind_rows(\n  get_metrics(0.9),\n  get_metrics(0.4)\n)\n\nmetrics\n\n\n# A tibble: 2 × 9\n  threshold    TN    FP    FN    TP accuracy sensitivity specificity    fpr\n      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;\n1       0.9 13116   493 42024  3707    0.284      0.0811     0.964   0.0362\n2       0.4    38 13571    23 45708    0.771      0.999      0.00279 0.997 \n\n\nInterpretation\nThreshold = 0.9 (Conservative) A threshold of 0.9 classifies an incident as a false alarm only when the predicted probability is extremely high.\nVery high specificity (96.4%): almost all true incidents are correctly labeled as real.\nVery low sensitivity (8.1%): the model fails to identify most false alarms (42,024 false negatives).\nThis threshold minimizes false positives but misses the vast majority of false alarms. This setting is appropriate in contexts where misclassifying a real emergency as a false alarm is unacceptable, such as prioritizing safety or enforcement on only the most extreme cases.\nThreshold = 0.4 (Aggressive) A threshold of 0.4 classifies an incident as a false alarm when the predicted probability exceeds 40%.\nExtremely high sensitivity (99.95%): nearly all false alarms are detected (only 23 missed).\nVery low specificity (0.28%): almost all true incidents are incorrectly labeled as false alarms.\nThis threshold identifies almost every false alarm but also generates a large number of false positives. This setting is useful in contexts where the goal is to maximize detection, such as broad preventive inspections or outreach."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#limitations",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#limitations",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "6.1 Limitations",
    "text": "6.1 Limitations\nAlthough the model provides meaningful predictive ability, it still faces several important limitations. First, the data contain gaps and inconsistencies, for example, missing or outdated fire-alarm certificate records and uneven data quality across neighborhoods which can reduce model stability. Second, because the current model is binary, it can only classify alarms as “false” vs. “not false,” and cannot distinguish different levels of fire risk. No matter how high or low the predicted probability is, the final decision still requires using a single threshold, which restricts how much nuance the model can express. In addition, any misclassification carries real consequences: mislabeling a true fire as a false alarm could delay response, while treating a likely false alarm as high risk may burden residents and property owners and potentially exacerbate existing enforcement inequities. For these reasons, the model should be used as a decision-support tool rather than a substitute for professional judgment."
  },
  {
    "objectID": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#improvement-possibilities",
    "href": "Projects/Fire Alarm Prediction/Fire-Alarm-Prediction.html#improvement-possibilities",
    "title": "Fire Alarm Prediction-Technical Appendix",
    "section": "6.2 Improvement Possibilities",
    "text": "6.2 Improvement Possibilities\nWith richer data, more development time, or additional funding, the model could be expanded into a multi-tier risk classification system, instead of a simple binary prediction. For example, alarms could be grouped into four levels:\n\nTier 1 = high emergency (very likely real fire)\nTier 2 = moderate risk (standard response)\nTier 3 = minor risk (non-emergency conditions possible)\nTier 4 = high-probability false alarm (light response package)\n\nAchieving this would require integrating additional features, such as alarm device age, building maintenance histories, humidity/smoke environment data, renovation activity, and more granular spatial patterns. These richer inputs would allow the model to shift from hard thresholding to continuous risk scoring and tiered operational strategies, enabling more precise allocation of fire-department resources. Future enhancements could also include multiclass models or time-series analysis to support an even more nuanced and safety-balanced dispatch framework."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Isabelle Li-Portfolio",
    "section": "",
    "text": "This portfolio showcases selected projects and analyses at the intersection of urban analytics, public policy, and spatial data science. It reflects both my technical training and my interest in applying data-driven methods to real-world planning and policy questions.\n\n\n\nSpatial data analysis and visualization\nUrban policy evaluation and modeling\nApplied data science for cities and communities\n\n\n\n\nProjects – End-to-end analytical work exploring real-world urban and policy problems through data.\nResearch – Research-driven projects examining cities, space, and policy through quantitative and spatial lenses.\nWriting – Reflections on policy, data, and urban issues, bridging technical analysis with human context.\n\n\n\nI recently graduated from the University of Toronto with an Honours Bachelor of Science in Mathematics and Economics.\nI am currently pursuing a Master of Urban Spatial Analytics at the University of Pennsylvania, where my work focuses on spatial analysis, public policy analytics, and applied data science for urban contexts.\nI am particularly interested in roles that bridge data, policy, and decision-making, translating quantitative analysis into actionable insights.\n\n\n\n\nEmail: [isabli@upenn.edu]\nGitHub: [@Isabelliiii]\nLinkedin: [https://www.linkedin.com/in/isabellelii]"
  },
  {
    "objectID": "index.html#focus-area",
    "href": "index.html#focus-area",
    "title": "Isabelle Li-Portfolio",
    "section": "",
    "text": "Spatial data analysis and visualization\nUrban policy evaluation and modeling\nApplied data science for cities and communities"
  },
  {
    "objectID": "index.html#portfolio-structure",
    "href": "index.html#portfolio-structure",
    "title": "Isabelle Li-Portfolio",
    "section": "",
    "text": "Projects – End-to-end analytical work exploring real-world urban and policy problems through data.\nResearch – Research-driven projects examining cities, space, and policy through quantitative and spatial lenses.\nWriting – Reflections on policy, data, and urban issues, bridging technical analysis with human context."
  },
  {
    "objectID": "index.html#about-me",
    "href": "index.html#about-me",
    "title": "Isabelle Li-Portfolio",
    "section": "",
    "text": "I recently graduated from the University of Toronto with an Honours Bachelor of Science in Mathematics and Economics.\nI am currently pursuing a Master of Urban Spatial Analytics at the University of Pennsylvania, where my work focuses on spatial analysis, public policy analytics, and applied data science for urban contexts.\nI am particularly interested in roles that bridge data, policy, and decision-making, translating quantitative analysis into actionable insights."
  },
  {
    "objectID": "index.html#contact",
    "href": "index.html#contact",
    "title": "Isabelle Li-Portfolio",
    "section": "",
    "text": "Email: [isabli@upenn.edu]\nGitHub: [@Isabelliiii]\nLinkedin: [https://www.linkedin.com/in/isabellelii]"
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#data-sources",
    "href": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#data-sources",
    "title": "Philadelphia Housing Price Prediction",
    "section": "Data Sources",
    "text": "Data Sources\n\n\n\n\n\n\n\n\nSource\nDescription\nKey Variables / Features\n\n\n\n\nOPA Property Sales\n2023–2024 residential transactions\nsale_price, total_livable_area, number_of_bedrooms, number_of_bathrooms, house_age, garage_spaces\n\n\nCensus ACS 2023\nSocioeconomic indicators by tract\nmedian_income, ba_rate, unemployment_rate, total_pop\n\n\nOpenDataPhilly – Transit\nPublic transit locations\nCount of stops within 400 m buffer (transit_count)\n\n\nOpenDataPhilly – Recreation / Parks\nRecreation locations\nCount within 1200 m buffer (recreation_count), categorical dummy (recreation_dummy)\n\n\nOpenDataPhilly – Crime\nCrime incidents\nCount of incidents within 400 m (crime_count)\n\n\nHospitals\nHospital locations\nDistance to nearest hospital (nearest_hospital_m)\n\n\nCenter City boundary\nGeojson polygon\nBinary dummy (center_city_dummy)"
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#data-overview",
    "href": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#data-overview",
    "title": "Philadelphia Housing Price Prediction",
    "section": "Data Overview",
    "text": "Data Overview"
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#where-are-expensive-homes",
    "href": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#where-are-expensive-homes",
    "title": "Philadelphia Housing Price Prediction",
    "section": "Where Are Expensive Homes?",
    "text": "Where Are Expensive Homes?"
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#what-drives-prices",
    "href": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#what-drives-prices",
    "title": "Philadelphia Housing Price Prediction",
    "section": "What Drives Prices?",
    "text": "What Drives Prices?"
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#top-predictors",
    "href": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#top-predictors",
    "title": "Philadelphia Housing Price Prediction",
    "section": "Top Predictors",
    "text": "Top Predictors"
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#model-performance",
    "href": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#model-performance",
    "title": "Philadelphia Housing Price Prediction",
    "section": "Model Performance",
    "text": "Model Performance"
  },
  {
    "objectID": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#hardest-to-predict",
    "href": "Projects/Philadelphia Housing Model/Li_Isabelle_Slides.html#hardest-to-predict",
    "title": "Philadelphia Housing Price Prediction",
    "section": "Hardest to Predict",
    "text": "Hardest to Predict"
  }
]